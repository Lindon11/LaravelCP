import{_ as D,e as P,h as u,a as e,t as n,l as b,k as v,m as k,s as N,F as L,i as E,j as I,v as V,x as y,g as p,q as H,y as W,r as j,o as i,n as T,c as q,w as z,d as Y}from"./index-BVasWiLC.js";const G={class:"notifications-page"},J={class:"page-header"},K={class:"header-left"},O={key:0,class:"unread-badge"},Q={class:"header-actions"},X=["disabled"],Z=["disabled"],tt=["disabled"],et={class:"filters-bar"},at={class:"filter-group"},ot={class:"filter-group"},st={class:"filter-group"},lt={key:0,class:"notifications-list"},nt={key:0,class:"empty-state"},it={class:"notification-icon"},rt={class:"notification-content"},dt={class:"notification-header"},ut={class:"notification-meta"},pt={class:"time"},vt={class:"notification-message"},ct={class:"notification-actions"},ft=["onClick"],mt=["onClick"],gt={key:1,class:"loading-state"},yt={key:2,class:"pagination"},bt=["disabled"],_t={class:"page-info"},kt=["disabled"],wt={class:"modal"},Ct={class:"modal-header"},ht={class:"modal-body"},Nt={class:"form-group"},Vt={class:"form-group"},Tt={class:"form-row"},xt={class:"form-group"},St={class:"form-group"},Ut={class:"form-group"},Ft={class:"modal-footer"},Mt=["disabled"],At={__name:"NotificationsView",setup(Rt){const s=W(),h=p(!0),w=p(!1),C=p(!1),r=p([]),c=p(0),_=p(!1),d=p({current_page:1,last_page:1,per_page:20,total:0}),f=p({status:"all",type:"all",priority:"all"}),l=p({title:"",message:"",type:"info",priority:"normal",link:""}),S=H(()=>r.value.some(o=>o.is_read)),m=async(o=1)=>{h.value=!0;try{const t={page:o,per_page:d.value.per_page,...f.value},g=await y.get("/admin/notifications",{params:t});r.value=g.data.notifications,d.value=g.data.pagination,c.value=g.data.unread_count}catch(t){s.error("Failed to load notifications"),console.error(t)}finally{h.value=!1}},x=o=>{m(o)},U=async o=>{try{await y.post(`/admin/notifications/${o}/read`);const t=r.value.find(g=>g.id===o);t&&(t.is_read=!0,c.value=Math.max(0,c.value-1)),s.success("Marked as read")}catch{s.error("Failed to mark as read")}},F=async()=>{try{const o=await y.post("/admin/notifications/read-all");r.value.forEach(t=>t.is_read=!0),c.value=0,s.success(o.data.message)}catch{s.error("Failed to mark all as read")}},M=async o=>{if(confirm("Delete this notification?"))try{await y.delete(`/admin/notifications/${o}`),r.value=r.value.filter(t=>t.id!==o),s.success("Notification deleted")}catch{s.error("Failed to delete notification")}},A=async()=>{if(confirm("Delete all read notifications?"))try{const o=await y.delete("/admin/notifications/clear-read");r.value=r.value.filter(t=>!t.is_read),s.success(o.data.message)}catch{s.error("Failed to clear notifications")}},R=async()=>{w.value=!0;try{await y.post("/admin/notifications/test"),s.success("Test notification sent!"),m()}catch{s.error("Failed to send test notification")}finally{w.value=!1}},$=async()=>{C.value=!0;try{await y.post("/admin/notifications/broadcast",l.value),s.success("Broadcast sent to all admins!"),_.value=!1,l.value={title:"",message:"",type:"info",priority:"normal",link:""},m()}catch{s.error("Failed to send broadcast")}finally{C.value=!1}};return P(()=>{m()}),(o,t)=>{const g=j("router-link");return i(),u("div",G,[e("div",J,[e("div",K,[c.value>0?(i(),u("span",O,n(c.value)+" unread",1)):b("",!0)]),e("div",Q,[e("button",{class:"btn btn-secondary",onClick:R,disabled:w.value},n(w.value?"Sending...":"ðŸ§ª Send Test"),9,X),e("button",{class:"btn btn-secondary",onClick:F,disabled:c.value===0}," âœ“ Mark All Read ",8,Z),e("button",{class:"btn btn-danger",onClick:A,disabled:!S.value}," ðŸ—‘ï¸ Clear Read ",8,tt)])]),e("div",et,[e("div",at,[t[14]||(t[14]=e("label",null,"Status:",-1)),v(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>f.value.status=a),onChange:m},[...t[13]||(t[13]=[e("option",{value:"all"},"All",-1),e("option",{value:"unread"},"Unread",-1),e("option",{value:"read"},"Read",-1)])],544),[[k,f.value.status]])]),e("div",ot,[t[16]||(t[16]=e("label",null,"Type:",-1)),v(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>f.value.type=a),onChange:m},[...t[15]||(t[15]=[N('<option value="all" data-v-44f981ff>All Types</option><option value="info" data-v-44f981ff>Info</option><option value="success" data-v-44f981ff>Success</option><option value="warning" data-v-44f981ff>Warning</option><option value="error" data-v-44f981ff>Error</option><option value="task" data-v-44f981ff>Task</option><option value="user" data-v-44f981ff>User</option><option value="system" data-v-44f981ff>System</option><option value="report" data-v-44f981ff>Report</option><option value="ticket" data-v-44f981ff>Ticket</option>',10)])],544),[[k,f.value.type]])]),e("div",st,[t[18]||(t[18]=e("label",null,"Priority:",-1)),v(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>f.value.priority=a),onChange:m},[...t[17]||(t[17]=[N('<option value="all" data-v-44f981ff>All Priorities</option><option value="urgent" data-v-44f981ff>Urgent</option><option value="high" data-v-44f981ff>High</option><option value="normal" data-v-44f981ff>Normal</option><option value="low" data-v-44f981ff>Low</option>',5)])],544),[[k,f.value.priority]])])]),h.value?(i(),u("div",gt,[...t[21]||(t[21]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Loading notifications...",-1)])])):(i(),u("div",lt,[r.value.length===0?(i(),u("div",nt,[...t[19]||(t[19]=[e("span",{class:"empty-icon"},"ðŸ“­",-1),e("h3",null,"No notifications",-1),e("p",null,"You're all caught up!",-1)])])):b("",!0),(i(!0),u(L,null,E(r.value,a=>(i(),u("div",{key:a.id,class:T(["notification-card",{unread:!a.is_read,[a.priority]:!0,[a.type]:!0}])},[e("div",it,n(a.icon),1),e("div",rt,[e("div",dt,[e("h3",null,n(a.title),1),e("div",ut,[e("span",{class:T(["priority-badge",a.priority])},n(a.priority),3),e("span",{class:T(["type-badge",a.type])},n(a.type),3),e("span",pt,n(a.time_ago),1)])]),e("p",vt,n(a.message),1),e("div",ct,[a.is_read?b("",!0):(i(),u("button",{key:0,class:"btn btn-small btn-primary",onClick:B=>U(a.id)}," Mark as Read ",8,ft)),a.link?(i(),q(g,{key:1,to:a.link,class:"btn btn-small btn-secondary"},{default:z(()=>[...t[20]||(t[20]=[Y(" View Details â†’ ",-1)])]),_:1},8,["to"])):b("",!0),e("button",{class:"btn btn-small btn-danger",onClick:B=>M(a.id)}," Delete ",8,mt)])])],2))),128))])),d.value.last_page>1?(i(),u("div",yt,[e("button",{class:"btn btn-secondary",onClick:t[3]||(t[3]=a=>x(d.value.current_page-1)),disabled:d.value.current_page===1}," â† Previous ",8,bt),e("span",_t," Page "+n(d.value.current_page)+" of "+n(d.value.last_page),1),e("button",{class:"btn btn-secondary",onClick:t[4]||(t[4]=a=>x(d.value.current_page+1)),disabled:d.value.current_page===d.value.last_page}," Next â†’ ",8,kt)])):b("",!0),_.value?(i(),u("div",{key:3,class:"modal-overlay",onClick:t[12]||(t[12]=I(a=>_.value=!1,["self"]))},[e("div",wt,[e("div",Ct,[t[22]||(t[22]=e("h2",null,"Broadcast Notification",-1)),e("button",{class:"close-btn",onClick:t[5]||(t[5]=a=>_.value=!1)},"âœ•")]),e("div",ht,[e("div",Nt,[t[23]||(t[23]=e("label",null,"Title",-1)),v(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>l.value.title=a),type:"text",placeholder:"Notification title"},null,512),[[V,l.value.title]])]),e("div",Vt,[t[24]||(t[24]=e("label",null,"Message",-1)),v(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=a=>l.value.message=a),rows:"4",placeholder:"Notification message"},null,512),[[V,l.value.message]])]),e("div",Tt,[e("div",xt,[t[26]||(t[26]=e("label",null,"Type",-1)),v(e("select",{"onUpdate:modelValue":t[8]||(t[8]=a=>l.value.type=a)},[...t[25]||(t[25]=[N('<option value="info" data-v-44f981ff>Info</option><option value="success" data-v-44f981ff>Success</option><option value="warning" data-v-44f981ff>Warning</option><option value="error" data-v-44f981ff>Error</option><option value="system" data-v-44f981ff>System</option>',5)])],512),[[k,l.value.type]])]),e("div",St,[t[28]||(t[28]=e("label",null,"Priority",-1)),v(e("select",{"onUpdate:modelValue":t[9]||(t[9]=a=>l.value.priority=a)},[...t[27]||(t[27]=[e("option",{value:"low"},"Low",-1),e("option",{value:"normal"},"Normal",-1),e("option",{value:"high"},"High",-1),e("option",{value:"urgent"},"Urgent",-1)])],512),[[k,l.value.priority]])])]),e("div",Ut,[t[29]||(t[29]=e("label",null,"Link (optional)",-1)),v(e("input",{"onUpdate:modelValue":t[10]||(t[10]=a=>l.value.link=a),type:"text",placeholder:"/dashboard"},null,512),[[V,l.value.link]])])]),e("div",Ft,[e("button",{class:"btn btn-secondary",onClick:t[11]||(t[11]=a=>_.value=!1)},"Cancel"),e("button",{class:"btn btn-primary",onClick:$,disabled:C.value},n(C.value?"Sending...":"Send to All Admins"),9,Mt)])])])):b("",!0)])}}},Bt=D(At,[["__scopeId","data-v-44f981ff"]]);export{Bt as default};
