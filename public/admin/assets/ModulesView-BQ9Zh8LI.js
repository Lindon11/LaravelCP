import{_ as q,e as K,h as o,a as e,d as _,p as z,l as c,F as C,i as w,j as F,t as n,s as f,g as v,q as T,A as R,o as a}from"./index-c4XIp2mo.js";const W={class:"modules-page"},G={class:"modules-header"},H={class:"header-actions"},J={class:"tabs"},O={key:0,class:"loading"},Q={key:1,class:"modules-grid"},X={key:0,class:"no-modules"},Y={class:"module-header"},ss={class:"module-icon"},es={class:"module-info"},ls={class:"module-meta"},ts={class:"version"},os={key:0,class:"author"},as={class:"module-status"},ns={class:"module-description"},is={key:0,class:"dependencies"},ds={class:"module-actions"},us=["onClick"],rs=["onClick"],cs=["onClick"],vs={key:2,class:"modules-grid"},ps={key:0,class:"no-modules"},ms={class:"module-header"},bs={class:"module-icon"},fs={class:"module-info"},ys={class:"module-meta"},gs={class:"version"},ks={key:0,class:"author"},hs={class:"module-description"},_s={key:0,class:"dependencies"},Ms={class:"module-actions"},Cs=["onClick"],ws={class:"modal-header"},Fs={class:"modal-body"},$s={key:0,class:"file-info"},Us={class:"file-size"},zs={class:"modal-footer"},Is=["disabled"],Bs={class:"modal-header"},Ds={class:"modal-body"},Ts={class:"modal-footer"},Ns={__name:"ModulesView",setup(Ps){const{success:y,error:d}=R(),$=v([]),U=v(!0),g=v("installed"),m=v(!1),b=v(!1),u=v(null),M=v(!1),k=v(null),N=v(null),I=T(()=>$.value.filter(t=>t.installed)),B=T(()=>$.value.filter(t=>!t.installed)),D=t=>({module:"ðŸŽ®",theme:"ðŸŽ¨",plugin:"ðŸ”Œ"})[t]||"ðŸ“¦",p=async()=>{U.value=!0;try{const t=await f.get("/admin/modules");$.value=t.data.modules||[]}catch(t){console.error("Failed to load modules:",t),d("Failed to load modules")}finally{U.value=!1}},P=async t=>{var s,i;try{await f.put(`/admin/modules/${t}/enable`),y("Module enabled"),await p()}catch(l){console.error("Failed to enable module:",l),d(((i=(s=l.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to enable module")}},V=async t=>{try{await f.put(`/admin/modules/${t}/disable`),y("Module disabled"),await p()}catch(s){console.error("Failed to disable module:",s),d("Failed to disable module")}},x=async t=>{var s,i;try{await f.post(`/admin/modules/${t}/install`),y("Module installed successfully"),await p()}catch(l){console.error("Failed to install module:",l),d(((i=(s=l.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to install module")}},E=t=>{k.value=t,b.value=!0},S=async()=>{var t,s;if(k.value)try{await f.delete(`/admin/modules/${k.value.slug}`),y("Module uninstalled successfully"),b.value=!1,k.value=null,await p()}catch(i){console.error("Failed to uninstall module:",i),d(((s=(t=i.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to uninstall module")}},Z=t=>{const s=t.target.files[0];if(s){if(s.size>10*1024*1024){d("File size must be less than 10MB");return}u.value=s}},A=t=>{const s=t.dataTransfer.files[0];if(s&&s.name.endsWith(".zip")){if(s.size>10*1024*1024){d("File size must be less than 10MB");return}u.value=s}else d("Please upload a ZIP file")},L=async()=>{var s,i;if(!u.value)return;M.value=!0;const t=new FormData;t.append("file",u.value),t.append("type","module");try{await f.post("/admin/modules/upload",t,{headers:{"Content-Type":"multipart/form-data"}}),y("Module uploaded successfully"),m.value=!1,u.value=null,await p()}catch(l){console.error("Failed to upload module:",l),d(((i=(s=l.response)==null?void 0:s.data)==null?void 0:i.message)||"Failed to upload module")}finally{M.value=!1}},j=t=>{if(t===0)return"0 Bytes";const s=1024,i=["Bytes","KB","MB"],l=Math.floor(Math.log(t)/Math.log(s));return Math.round(t/Math.pow(s,l)*100)/100+" "+i[l]};return K(()=>{p()}),(t,s)=>{var i;return a(),o("div",W,[e("div",G,[s[15]||(s[15]=e("h1",null,"ðŸ“¦ Module Manager",-1)),e("div",H,[e("button",{class:"btn-secondary",onClick:s[0]||(s[0]=l=>m.value=!0)},[...s[13]||(s[13]=[e("span",null,"â¬†ï¸",-1),_(" Upload Module ",-1)])]),e("button",{class:"btn-primary",onClick:p},[...s[14]||(s[14]=[e("span",null,"ðŸ”„",-1),_(" Refresh ",-1)])])])]),e("div",J,[e("button",{class:z({active:g.value==="installed"}),onClick:s[1]||(s[1]=l=>g.value="installed")}," Installed Modules ",2),e("button",{class:z({active:g.value==="available"}),onClick:s[2]||(s[2]=l=>g.value="available")}," Available Modules ",2)]),U.value?(a(),o("div",O,[...s[16]||(s[16]=[e("div",{class:"spinner"},null,-1),_(" Loading modules... ",-1)])])):g.value==="installed"?(a(),o("div",Q,[I.value.length===0?(a(),o("div",X,[...s[17]||(s[17]=[e("p",null,"No modules installed.",-1),e("p",{class:"hint"},"Upload a module ZIP file to get started.",-1)])])):c("",!0),(a(!0),o(C,null,w(I.value,l=>{var h;return a(),o("div",{key:l.slug,class:"module-card installed"},[e("div",Y,[e("div",ss,n(D(l.type)),1),e("div",es,[e("h3",null,n(l.name),1),e("div",ls,[e("span",ts,"v"+n(l.version),1),l.author?(a(),o("span",os,"by "+n(l.author),1)):c("",!0)])]),e("div",as,[e("span",{class:z(["badge",l.enabled?"badge-success":"badge-disabled"])},n(l.enabled?"Enabled":"Disabled"),3)])]),e("p",ns,n(l.description||"No description available"),1),(h=l.dependencies)!=null&&h.length?(a(),o("div",is,[s[18]||(s[18]=e("strong",null,"Dependencies:",-1)),(a(!0),o(C,null,w(l.dependencies,r=>(a(),o("span",{key:r,class:"dep-tag"},n(r),1))),128))])):c("",!0),e("div",ds,[l.enabled?(a(),o("button",{key:0,class:"btn-action btn-warning",onClick:r=>V(l.slug)}," Disable ",8,us)):(a(),o("button",{key:1,class:"btn-action btn-success",onClick:r=>P(l.slug)}," Enable ",8,rs)),e("button",{class:"btn-action btn-danger",onClick:r=>E(l)}," Uninstall ",8,cs)])])}),128))])):(a(),o("div",vs,[B.value.length===0?(a(),o("div",ps,[...s[19]||(s[19]=[e("p",null,"No modules available for installation.",-1),e("p",{class:"hint"},"Upload module ZIP files to install them.",-1)])])):c("",!0),(a(!0),o(C,null,w(B.value,l=>{var h;return a(),o("div",{key:l.slug,class:"module-card available"},[e("div",ms,[e("div",bs,n(D(l.type)),1),e("div",fs,[e("h3",null,n(l.name),1),e("div",ys,[e("span",gs,"v"+n(l.version),1),l.author?(a(),o("span",ks,"by "+n(l.author),1)):c("",!0)])])]),e("p",hs,n(l.description||"No description available"),1),(h=l.dependencies)!=null&&h.length?(a(),o("div",_s,[s[20]||(s[20]=e("strong",null,"Dependencies:",-1)),(a(!0),o(C,null,w(l.dependencies,r=>(a(),o("span",{key:r,class:"dep-tag"},n(r),1))),128))])):c("",!0),e("div",Ms,[e("button",{class:"btn-action btn-primary",onClick:r=>x(l.slug)}," Install ",8,Cs)])])}),128))])),m.value?(a(),o("div",{key:3,class:"modal-overlay",onClick:s[8]||(s[8]=l=>m.value=!1)},[e("div",{class:"modal",onClick:s[7]||(s[7]=F(()=>{},["stop"]))},[e("div",ws,[s[21]||(s[21]=e("h2",null,"Upload Module",-1)),e("button",{class:"btn-close",onClick:s[3]||(s[3]=l=>m.value=!1)},"Ã—")]),e("div",Fs,[e("div",{class:"upload-area",onDragover:s[5]||(s[5]=F(()=>{},["prevent"])),onDrop:F(A,["prevent"])},[e("input",{ref_key:"fileInput",ref:N,type:"file",accept:".zip",onChange:Z,style:{display:"none"}},null,544),e("div",{class:"upload-prompt",onClick:s[4]||(s[4]=l=>t.$refs.fileInput.click())},[...s[22]||(s[22]=[e("span",{class:"upload-icon"},"ðŸ“¦",-1),e("p",null,"Click to select or drag & drop module ZIP file",-1),e("p",{class:"hint"},"Maximum file size: 10MB",-1)])])],32),u.value?(a(),o("div",$s,[e("span",null,"ðŸ“„ "+n(u.value.name),1),e("span",Us,n(j(u.value.size)),1)])):c("",!0)]),e("div",zs,[e("button",{class:"btn-cancel",onClick:s[6]||(s[6]=l=>m.value=!1)},"Cancel"),e("button",{class:"btn-submit",disabled:!u.value||M.value,onClick:L},n(M.value?"Uploading...":"Upload"),9,Is)])])])):c("",!0),b.value?(a(),o("div",{key:4,class:"modal-overlay",onClick:s[12]||(s[12]=l=>b.value=!1)},[e("div",{class:"modal modal-confirm",onClick:s[11]||(s[11]=F(()=>{},["stop"]))},[e("div",Bs,[s[23]||(s[23]=e("h2",null,"Confirm Uninstall",-1)),e("button",{class:"btn-close",onClick:s[9]||(s[9]=l=>b.value=!1)},"Ã—")]),e("div",Ds,[e("p",null,[s[24]||(s[24]=_("Are you sure you want to uninstall ",-1)),e("strong",null,n((i=k.value)==null?void 0:i.name),1),s[25]||(s[25]=_("?",-1))]),s[26]||(s[26]=e("p",{class:"warning"},"This will remove all module files and database entries. This action cannot be undone.",-1))]),e("div",Ts,[e("button",{class:"btn-cancel",onClick:s[10]||(s[10]=l=>b.value=!1)},"Cancel"),e("button",{class:"btn-danger",onClick:S},"Uninstall")])])])):c("",!0)])}}},xs=q(Ns,[["__scopeId","data-v-89c88510"]]);export{xs as default};
