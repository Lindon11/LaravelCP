import{e as J,h as a,a as t,n as y,b as d,z as u,V as A,d as f,k as C,v as O,m as N,s as R,E,an as G,F as T,i as $,l as c,j as q,D as W,t as n,f as _,g as v,q as H,o as l,J as K,ao as Q}from"./index-B2ti7znc.js";import{r as X}from"./CheckCircleIcon-BVdV7uoT.js";const Y={class:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-6"},Z={class:"max-w-7xl mx-auto space-y-6"},tt={class:"flex items-center justify-end gap-3"},et={key:0,class:"space-y-6"},st={class:"bg-slate-800 rounded-lg p-6 border border-slate-700"},ot={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},at={class:"flex gap-3 mt-4"},lt={class:"bg-slate-800 rounded-lg border border-slate-700 overflow-hidden"},it={key:0,class:"p-8 text-center"},nt={key:1,class:"p-8 text-center"},rt={key:2,class:"overflow-x-auto"},dt={class:"min-w-full divide-y divide-slate-700"},ut={class:"divide-y divide-slate-700"},ct={class:"px-6 py-4 whitespace-nowrap"},pt={class:"flex items-center"},mt={class:"text-slate-200 font-medium"},vt={class:"px-6 py-4 whitespace-nowrap"},gt={class:"px-6 py-4"},xt={class:"text-slate-300 text-sm"},bt={class:"px-6 py-4 whitespace-nowrap"},yt={class:"text-slate-400 text-sm font-mono"},ft={class:"px-6 py-4 whitespace-nowrap"},_t={class:"text-slate-400 text-sm"},ht={class:"px-6 py-4 whitespace-nowrap"},kt=["onClick"],wt={key:1,class:"space-y-6"},At={class:"bg-slate-800 rounded-lg p-6 border border-red-500/30"},Ct={key:0,class:"p-8 text-center"},Tt={key:1},$t={key:0,class:"mb-6"},Dt={class:"text-xl font-bold text-red-400 mb-4 flex items-center"},Ft={class:"space-y-3"},Lt={class:"flex items-center justify-between"},Vt={class:"text-slate-200 font-medium"},Bt={class:"text-slate-400 text-sm ml-2"},St=["onClick"],Ut={key:1},jt={class:"text-xl font-bold text-red-400 mb-4 flex items-center"},Nt={class:"space-y-3"},It={class:"flex items-center justify-between"},Pt={class:"text-slate-200 font-medium"},zt={class:"text-slate-400 text-sm ml-2"},Mt=["onClick"],Jt={key:2,class:"text-center py-8"},Ot={class:"bg-slate-800 rounded-lg p-6 max-w-2xl w-full border border-slate-700"},Rt={class:"flex items-center justify-between mb-4"},Et={class:"space-y-4"},Gt={class:"text-slate-200 font-medium"},qt={class:"text-slate-300"},Wt={key:0,class:"bg-slate-700 rounded-lg p-4"},Ht={class:"text-slate-300 text-sm overflow-x-auto"},Kt={class:"grid grid-cols-2 gap-4"},Qt={class:"text-slate-300 font-mono text-sm"},Xt={class:"text-slate-300 text-sm"},Yt={key:1},Zt={class:"text-slate-300 text-sm break-words"},te={class:"flex justify-end gap-3 mt-6"},ae={__name:"ActivityLogsView",setup(ee){const p=v("logs"),x=v(!1),h=v(!1),k=v([]),m=v({}),i=v(null),r=v({username:"",type:"",limit:100}),D=H(()=>{let o=k.value;return r.value.username&&(o=o.filter(e=>{var g;return(g=e.username)==null?void 0:g.toLowerCase().includes(r.value.username.toLowerCase())})),o}),F=o=>"px-3 py-1 rounded-full text-xs font-medium "+({login:"bg-green-500/20 text-green-400",logout:"bg-slate-500/20 text-slate-400",register:"bg-blue-500/20 text-blue-400",crime_attempt:"bg-purple-500/20 text-purple-400",combat:"bg-red-500/20 text-red-400",bank_deposit:"bg-emerald-500/20 text-emerald-400",bank_withdrawal:"bg-amber-500/20 text-amber-400",bank_transfer:"bg-cyan-500/20 text-cyan-400",gym_train:"bg-orange-500/20 text-orange-400",travel:"bg-sky-500/20 text-sky-400",item_purchase:"bg-indigo-500/20 text-indigo-400",item_sold:"bg-violet-500/20 text-violet-400",bounty_placed:"bg-rose-500/20 text-rose-400",bounty_claimed:"bg-pink-500/20 text-pink-400",gang_join:"bg-teal-500/20 text-teal-400",gang_leave:"bg-gray-500/20 text-gray-400",admin_action:"bg-red-500/20 text-red-400",banned:"bg-red-600/20 text-red-500",unbanned:"bg-green-600/20 text-green-500"}[o]||"bg-slate-500/20 text-slate-400"),L=o=>o.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),V=o=>{const e=new Date(o);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(e)},b=async()=>{x.value=!0;try{const o={limit:r.value.limit};r.value.type&&(o.type=r.value.type);const e=await _.get("/admin/activity",{params:o});k.value=e.data.activity||[]}catch(o){console.error("Failed to fetch activity logs:",o),alert("Failed to fetch activity logs")}finally{x.value=!1}},I=async()=>{h.value=!0;try{const o=await _.get("/admin/activity/suspicious");m.value=o.data.suspicious_activity||{}}catch(o){console.error("Failed to fetch suspicious activity:",o),alert("Failed to fetch suspicious activity")}finally{h.value=!1}},P=()=>{r.value={username:"",type:"",limit:100},b()},z=o=>{i.value=o},w=async o=>{i.value=null,r.value.username="",r.value.type="",p.value="logs",x.value=!0;try{const e=await _.get(`/admin/activity/user/${o}`);k.value=e.data.activity||[]}catch(e){console.error("Failed to fetch user activity:",e),alert("Failed to fetch user activity")}finally{x.value=!1}},M=async()=>{if(confirm("Are you sure you want to clean old activity logs? This action cannot be undone."))try{const o=await _.post("/admin/activity/clean");alert(o.data.message),b()}catch(o){console.error("Failed to clean old logs:",o),alert("Failed to clean old logs")}};return J(()=>{b(),I()}),(o,e)=>{var g,B,S,U;return l(),a("div",Y,[t("div",Z,[t("div",tt,[t("button",{onClick:e[0]||(e[0]=s=>p.value="logs"),class:y(["px-4 py-2 rounded-lg font-medium transition-all",p.value==="logs"?"bg-gradient-to-r from-orange-500 to-amber-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"])}," Activity Logs ",2),t("button",{onClick:e[1]||(e[1]=s=>p.value="suspicious"),class:y(["px-4 py-2 rounded-lg font-medium transition-all",p.value==="suspicious"?"bg-gradient-to-r from-red-500 to-orange-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"])},[d(u(A),{class:"w-5 h-5 inline mr-2"}),e[9]||(e[9]=f(" Suspicious Activity ",-1))],2)]),p.value==="logs"?(l(),a("div",et,[t("div",st,[t("div",ot,[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-slate-300 mb-2"},"Search User",-1)),C(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.username=s),type:"text",placeholder:"Enter username...",class:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-orange-500"},null,512),[[O,r.value.username]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-slate-300 mb-2"},"Activity Type",-1)),C(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.type=s),class:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-orange-500"},[...e[11]||(e[11]=[R('<option value="">All Types</option><option value="login">Login</option><option value="logout">Logout</option><option value="register">Register</option><option value="crime_attempt">Crime Attempt</option><option value="combat">Combat</option><option value="bank_deposit">Bank Deposit</option><option value="bank_withdrawal">Bank Withdrawal</option><option value="bank_transfer">Bank Transfer</option><option value="gym_train">Gym Training</option><option value="travel">Travel</option><option value="item_purchase">Item Purchase</option><option value="item_sold">Item Sold</option><option value="bounty_placed">Bounty Placed</option><option value="bounty_claimed">Bounty Claimed</option><option value="gang_join">Gang Join</option><option value="gang_leave">Gang Leave</option><option value="drug_buy">Drug Buy</option><option value="drug_sell">Drug Sell</option><option value="theft_attempt">Theft Attempt</option><option value="race_joined">Race Joined</option><option value="organized_crime">Organized Crime</option><option value="admin_action">Admin Action</option><option value="banned">Banned</option><option value="unbanned">Unbanned</option>',25)])],512),[[N,r.value.type]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-slate-300 mb-2"},"Records",-1)),C(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>r.value.limit=s),class:"w-full px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-orange-500"},[...e[13]||(e[13]=[t("option",{value:50},"50 records",-1),t("option",{value:100},"100 records",-1),t("option",{value:250},"250 records",-1),t("option",{value:500},"500 records",-1)])],512),[[N,r.value.limit]])])]),t("div",at,[t("button",{onClick:b,class:"px-6 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-all"}," Apply Filters "),t("button",{onClick:P,class:"px-6 py-2 bg-slate-700 text-slate-300 rounded-lg font-medium hover:bg-slate-600 transition-all"}," Reset "),t("button",{onClick:M,class:"ml-auto px-6 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-all"},[d(u(E),{class:"w-5 h-5 inline mr-2"}),e[15]||(e[15]=f(" Clean Old Logs ",-1))])])]),t("div",lt,[x.value?(l(),a("div",it,[...e[16]||(e[16]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"},null,-1),t("p",{class:"text-slate-400 mt-4"},"Loading activity logs...",-1)])])):D.value.length===0?(l(),a("div",nt,[d(u(G),{class:"w-16 h-16 text-slate-600 mx-auto mb-4"}),e[17]||(e[17]=t("p",{class:"text-slate-400"},"No activity logs found",-1))])):(l(),a("div",rt,[t("table",dt,[e[18]||(e[18]=t("thead",{class:"bg-slate-900"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider"},"User"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider"},"Type"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider"},"Description"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider"},"IP Address"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider"},"Time"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",ut,[(l(!0),a(T,null,$(D.value,s=>(l(),a("tr",{key:s.id,class:"hover:bg-slate-700 transition-colors"},[t("td",ct,[t("div",pt,[d(u(K),{class:"w-5 h-5 text-slate-400 mr-2"}),t("span",mt,n(s.username),1)])]),t("td",vt,[t("span",{class:y(F(s.type))},n(L(s.type)),3)]),t("td",gt,[t("span",xt,n(s.description),1)]),t("td",bt,[t("span",yt,n(s.ip_address||"N/A"),1)]),t("td",ft,[t("span",_t,n(V(s.created_at)),1)]),t("td",ht,[t("button",{onClick:j=>z(s),class:"text-orange-400 hover:text-orange-300 transition-colors"},[d(u(Q),{class:"w-5 h-5"})],8,kt)])]))),128))])])]))])])):c("",!0),p.value==="suspicious"?(l(),a("div",wt,[t("div",At,[h.value?(l(),a("div",Ct,[...e[19]||(e[19]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-red-500"},null,-1),t("p",{class:"text-slate-400 mt-4"},"Analyzing suspicious activity...",-1)])])):(l(),a("div",Tt,[(g=m.value.multiple_ips)!=null&&g.length?(l(),a("div",$t,[t("h3",Dt,[d(u(A),{class:"w-6 h-6 mr-2"}),e[20]||(e[20]=f(" Multiple IP Addresses ",-1))]),t("div",Ft,[(l(!0),a(T,null,$(m.value.multiple_ips,s=>(l(),a("div",{key:s.user_id,class:"bg-slate-700 rounded-lg p-4 border border-red-500/30"},[t("div",Lt,[t("div",null,[t("span",Vt,n(s.username),1),t("span",Bt,"("+n(s.ip_count)+" different IPs)",1)]),t("button",{onClick:j=>w(s.user_id),class:"text-orange-400 hover:text-orange-300 transition-colors text-sm"}," View Activity → ",8,St)])]))),128))])])):c("",!0),(B=m.value.rapid_actions)!=null&&B.length?(l(),a("div",Ut,[t("h3",jt,[d(u(A),{class:"w-6 h-6 mr-2"}),e[21]||(e[21]=f(" Rapid Actions (Possible Botting) ",-1))]),t("div",Nt,[(l(!0),a(T,null,$(m.value.rapid_actions,s=>(l(),a("div",{key:s.user_id,class:"bg-slate-700 rounded-lg p-4 border border-red-500/30"},[t("div",It,[t("div",null,[t("span",Pt,n(s.username),1),t("span",zt,"("+n(s.action_count)+" actions in 5 minutes)",1)]),t("button",{onClick:j=>w(s.user_id),class:"text-orange-400 hover:text-orange-300 transition-colors text-sm"}," View Activity → ",8,Mt)])]))),128))])])):c("",!0),!((S=m.value.multiple_ips)!=null&&S.length)&&!((U=m.value.rapid_actions)!=null&&U.length)?(l(),a("div",Jt,[d(u(X),{class:"w-16 h-16 text-green-500 mx-auto mb-4"}),e[22]||(e[22]=t("p",{class:"text-slate-400"},"No suspicious activity detected",-1))])):c("",!0)]))])])):c("",!0)]),i.value?(l(),a("div",{key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:e[8]||(e[8]=q(s=>i.value=null,["self"]))},[t("div",Ot,[t("div",Rt,[e[23]||(e[23]=t("h3",{class:"text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-amber-400"}," Activity Details ",-1)),t("button",{onClick:e[5]||(e[5]=s=>i.value=null),class:"text-slate-400 hover:text-slate-200"},[d(u(W),{class:"w-6 h-6"})])]),t("div",Et,[t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-slate-400 mb-1"},"User",-1)),t("p",Gt,n(i.value.username)+" (ID: "+n(i.value.user_id)+")",1)]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-slate-400 mb-1"},"Type",-1)),t("span",{class:y(F(i.value.type))},n(L(i.value.type)),3)]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-slate-400 mb-1"},"Description",-1)),t("p",qt,n(i.value.description),1)]),i.value.metadata?(l(),a("div",Wt,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-slate-400 mb-2"},"Metadata",-1)),t("pre",Ht,n(JSON.stringify(JSON.parse(i.value.metadata),null,2)),1)])):c("",!0),t("div",Kt,[t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-slate-400 mb-1"},"IP Address",-1)),t("p",Qt,n(i.value.ip_address||"N/A"),1)]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-slate-400 mb-1"},"Timestamp",-1)),t("p",Xt,n(V(i.value.created_at)),1)])]),i.value.user_agent?(l(),a("div",Yt,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-slate-400 mb-1"},"User Agent",-1)),t("p",Zt,n(i.value.user_agent),1)])):c("",!0)]),t("div",te,[t("button",{onClick:e[6]||(e[6]=s=>w(i.value.user_id)),class:"px-4 py-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-lg font-medium hover:from-orange-600 hover:to-amber-600 transition-all"}," View User's Activity "),t("button",{onClick:e[7]||(e[7]=s=>i.value=null),class:"px-4 py-2 bg-slate-700 text-slate-300 rounded-lg font-medium hover:bg-slate-600 transition-all"}," Close ")])])])):c("",!0)])}}};export{ae as default};
