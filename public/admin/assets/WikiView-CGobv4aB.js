import{_ as I,e as R,h as n,a as t,p as D,d as $,t as a,F as M,i as x,k as r,v as u,j as b,m as Q,x as G,l as E,s as v,g as c,q as H,z as N,o as i}from"./index-pYqw9Lqg.js";const J={class:"wiki-view"},K={class:"wiki-layout"},X={class:"categories-sidebar"},Y={class:"category-list"},Z={class:"count"},ee=["onClick"],te={class:"icon"},se={class:"count"},le={class:"articles-main"},oe={class:"search-bar"},ne={key:0,class:"loading-state"},ae={key:1,class:"empty-state"},ie={key:2,class:"articles-list"},re=["onClick"],de={class:"article-header"},ue={key:0,class:"status published"},ce={key:1,class:"status draft"},pe={class:"article-excerpt"},ve={class:"article-meta"},ge={class:"category"},me={class:"date"},be={class:"views"},ye=["onClick"],fe=["onClick","title"],ke=["onClick"],Ce={class:"modal-content large"},we={class:"modal-header"},_e={class:"form-grid"},he={class:"form-group full-width"},Ve={class:"form-group"},Ae=["value"],Me={class:"form-group"},xe={class:"form-group full-width"},Se={class:"form-group"},Ue={class:"form-group"},De={class:"checkbox-wrapper"},$e={class:"modal-actions"},Ee=["disabled"],Ne={class:"modal-content small"},qe={class:"form-group"},Le={class:"form-group"},Oe={class:"form-group"},Pe={__name:"WikiView",setup(Te){const V=c(!0),y=c(!1),f=c(!1),A=c(!1),p=c(null),g=c(""),k=c([]),C=c([]),o=N({id:null,title:"",slug:"",content:"",category_id:"",order:0,published:!1}),d=N({name:"",icon:"ðŸ“",order:0}),S=H(()=>{let l=k.value;if(p.value!==null&&(l=l.filter(e=>e.category_id===p.value)),g.value){const e=g.value.toLowerCase();l=l.filter(s=>s.title.toLowerCase().includes(e)||s.content.toLowerCase().includes(e))}return l}),m=async()=>{V.value=!0;try{const[l,e]=await Promise.all([v.get("/admin/content/wiki-pages"),v.get("/admin/content/wiki-categories")]);k.value=l.data.data||l.data||[],C.value=e.data.data||e.data||[]}catch(l){console.error("Error loading wiki data:",l)}finally{V.value=!1}},q=()=>{Object.assign(o,{id:null,title:"",slug:"",content:"",category_id:p.value||"",order:0,published:!1}),f.value=!0},U=l=>{Object.assign(o,l),f.value=!0},w=()=>{f.value=!1},L=async()=>{y.value=!0;try{o.id?await v.put(`/admin/content/wiki-pages/${o.id}`,o):await v.post("/admin/content/wiki-pages",o),await m(),w()}catch(l){console.error("Error saving article:",l)}finally{y.value=!1}},O=async l=>{try{await v.put(`/admin/content/wiki-pages/${l.id}`,{...l,published:!l.published}),await m()}catch(e){console.error("Error toggling publish:",e)}},P=async l=>{if(confirm(`Delete "${l.title}"? This cannot be undone.`))try{await v.delete(`/admin/content/wiki-pages/${l.id}`),await m()}catch(e){console.error("Error deleting article:",e)}},T=()=>{Object.assign(d,{name:"",icon:"ðŸ“",order:0}),A.value=!0},_=()=>{A.value=!1},j=async()=>{try{await v.post("/admin/content/wiki-categories",d),await m(),_()}catch(l){console.error("Error saving category:",l)}},z=l=>k.value.filter(e=>e.category_id===l).length,B=l=>{const e=C.value.find(s=>s.id===l);return(e==null?void 0:e.name)||"Uncategorized"},F=l=>new Date(l).toLocaleDateString(),W=(l,e)=>l?l.length>e?l.substring(0,e)+"...":l:"";return R(()=>{m()}),(l,e)=>(i(),n("div",J,[t("div",{class:"page-header"},[e[12]||(e[12]=t("div",{class:"header-content"},[t("h1",null,"ðŸ“š Wiki Management"),t("p",{class:"subtitle"},"Manage game documentation and help articles")],-1)),t("button",{class:"btn-create",onClick:q}," âž• New Article ")]),t("div",K,[t("aside",X,[e[15]||(e[15]=t("h3",null,"ðŸ“‚ Categories",-1)),t("ul",Y,[t("li",{class:D({active:p.value===null}),onClick:e[0]||(e[0]=s=>p.value=null)},[e[13]||(e[13]=t("span",{class:"icon"},"ðŸ“‹",-1)),e[14]||(e[14]=$(" All Articles ",-1)),t("span",Z,a(k.value.length),1)],2),(i(!0),n(M,null,x(C.value,s=>(i(),n("li",{key:s.id,class:D({active:p.value===s.id}),onClick:h=>p.value=s.id},[t("span",te,a(s.icon||"ðŸ“"),1),$(" "+a(s.name)+" ",1),t("span",se,a(z(s.id)),1)],10,ee))),128))]),t("div",{class:"category-actions"},[t("button",{class:"btn-add-category",onClick:T}," âž• Add Category ")])]),t("main",le,[t("div",oe,[r(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>g.value=s),type:"text",placeholder:"ðŸ” Search articles..."},null,512),[[u,g.value]])]),V.value?(i(),n("div",ne,[...e[16]||(e[16]=[t("div",{class:"spinner"},null,-1),t("p",null,"Loading articles...",-1)])])):S.value.length===0?(i(),n("div",ae,[e[17]||(e[17]=t("span",{class:"icon"},"ðŸ“",-1)),e[18]||(e[18]=t("h3",null,"No Articles Found",-1)),t("p",null,a(g.value?"Try a different search term":"Create your first wiki article"),1)])):(i(),n("div",ie,[(i(!0),n(M,null,x(S.value,s=>(i(),n("div",{key:s.id,class:"article-card",onClick:h=>U(s)},[t("div",de,[t("h4",null,a(s.title),1),s.published?(i(),n("span",ue,"Published")):(i(),n("span",ce,"Draft"))]),t("p",pe,a(W(s.content,150)),1),t("div",ve,[t("span",ge,"ðŸ“ "+a(B(s.category_id)),1),t("span",me,"ðŸ“… "+a(F(s.updated_at)),1),t("span",be,"ðŸ‘ï¸ "+a(s.views||0)+" views",1)]),t("div",{class:"article-actions",onClick:e[2]||(e[2]=b(()=>{},["stop"]))},[t("button",{class:"btn-icon",onClick:h=>U(s),title:"Edit"},"âœï¸",8,ye),t("button",{class:"btn-icon",onClick:h=>O(s),title:s.published?"Unpublish":"Publish"},a(s.published?"ðŸ“¤":"ðŸ“¥"),9,fe),t("button",{class:"btn-icon danger",onClick:h=>P(s),title:"Delete"},"ðŸ—‘ï¸",8,ke)])],8,re))),128))]))])]),f.value?(i(),n("div",{key:0,class:"modal-overlay",onClick:b(w,["self"])},[t("div",Ce,[t("div",we,[t("h2",null,a(o!=null&&o.id?"âœï¸ Edit Article":"ðŸ“ New Article"),1),t("button",{class:"close-btn",onClick:w},"âœ•")]),t("form",{onSubmit:b(L,["prevent"]),class:"modal-body"},[t("div",_e,[t("div",he,[e[19]||(e[19]=t("label",null,"Title *",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.title=s),type:"text",required:"",placeholder:"Article title"},null,512),[[u,o.title]])]),t("div",Ve,[e[21]||(e[21]=t("label",null,"Category *",-1)),r(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.category_id=s),required:""},[e[20]||(e[20]=t("option",{value:""},"Select Category",-1)),(i(!0),n(M,null,x(C.value,s=>(i(),n("option",{key:s.id,value:s.id},a(s.name),9,Ae))),128))],512),[[Q,o.category_id]])]),t("div",Me,[e[22]||(e[22]=t("label",null,"Slug",-1)),r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.slug=s),type:"text",placeholder:"auto-generated-from-title"},null,512),[[u,o.slug]])]),t("div",xe,[e[23]||(e[23]=t("label",null,"Content *",-1)),r(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.content=s),rows:"15",required:"",placeholder:"Article content... (Markdown supported)"},null,512),[[u,o.content]])]),t("div",Se,[e[24]||(e[24]=t("label",null,"Order",-1)),r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>o.order=s),type:"number",min:"0"},null,512),[[u,o.order,void 0,{number:!0}]])]),t("div",Ue,[e[26]||(e[26]=t("label",null,"Status",-1)),t("div",De,[r(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.published=s),type:"checkbox",id:"published"},null,512),[[G,o.published]]),e[25]||(e[25]=t("label",{for:"published"},"Published",-1))])])]),t("div",$e,[t("button",{type:"button",class:"btn-secondary",onClick:w},"Cancel"),t("button",{type:"submit",class:"btn-primary",disabled:y.value},a(y.value?"ðŸ’¾ Saving...":"ðŸ’¾ Save Article"),9,Ee)])],32)])])):E("",!0),A.value?(i(),n("div",{key:1,class:"modal-overlay",onClick:b(_,["self"])},[t("div",Ne,[t("div",{class:"modal-header"},[e[27]||(e[27]=t("h2",null,"ðŸ“‚ Add Category",-1)),t("button",{class:"close-btn",onClick:_},"âœ•")]),t("form",{onSubmit:b(j,["prevent"]),class:"modal-body"},[t("div",qe,[e[28]||(e[28]=t("label",null,"Name *",-1)),r(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>d.name=s),type:"text",required:"",placeholder:"Category name"},null,512),[[u,d.name]])]),t("div",Le,[e[29]||(e[29]=t("label",null,"Icon",-1)),r(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>d.icon=s),type:"text",placeholder:"ðŸ“"},null,512),[[u,d.icon]])]),t("div",Oe,[e[30]||(e[30]=t("label",null,"Order",-1)),r(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>d.order=s),type:"number",min:"0"},null,512),[[u,d.order,void 0,{number:!0}]])]),t("div",{class:"modal-actions"},[t("button",{type:"button",class:"btn-secondary",onClick:_},"Cancel"),e[31]||(e[31]=t("button",{type:"submit",class:"btn-primary"},"Save Category",-1))])],32)])])):E("",!0)]))}},ze=I(Pe,[["__scopeId","data-v-dff5811a"]]);export{ze as default};
