import{o as a,h as l,a as e,_ as H,e as Q,x as f,b as u,A as p,B as Z,k as $,v as L,d as J,C as K,t as i,F as w,i as k,D as M,l as S,c as O,w as W,T as X,E as Y,g as c,q as T,G as ee,H as se,I as te,y as oe}from"./index-BJoLCnnK.js";function ae(D,m){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"})])}function le(D,m){return a(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}const re={class:"space-y-6"},ne={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4"},ie={class:"relative w-full sm:w-80"},de={key:0,class:"rounded-2xl bg-slate-800/50 backdrop-blur border border-slate-700/50 p-12"},ce={key:1,class:"rounded-2xl bg-red-500/10 border border-red-500/30 p-6"},ue={class:"flex items-center gap-3"},me={class:"text-red-400 font-medium"},pe={key:2,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6"},ve={class:"flex items-start justify-between mb-4"},xe={class:"flex items-center gap-3"},be={class:"w-10 h-10 rounded-xl bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center"},fe={class:"font-semibold text-white group-hover:text-amber-400 transition-colors"},he={class:"text-xs text-slate-400"},ge={class:"flex items-center gap-1"},_e=["onClick"],ye=["onClick"],we={class:"space-y-3"},ke={class:"flex items-center justify-between"},Ce={class:"text-xs font-medium text-slate-500"},Re={key:0,class:"flex flex-wrap gap-1.5"},je={key:0,class:"px-2 py-1 text-xs font-medium rounded-md bg-amber-500/20 text-amber-400"},$e={key:1,class:"text-sm text-slate-500 italic"},Se={key:0,class:"col-span-full flex flex-col items-center justify-center py-12"},De={class:"w-16 h-16 rounded-2xl bg-slate-700/30 flex items-center justify-center mb-4"},Ne={class:"text-slate-400 text-center max-w-sm"},Ve={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Be={class:"relative bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col"},Le={class:"flex items-center justify-between p-6 border-b border-slate-700 shrink-0"},Me={class:"text-lg font-bold text-white"},Te={class:"p-6 overflow-y-auto flex-1 space-y-6"},Fe={class:"space-y-2"},Pe={class:"space-y-3"},Ae={class:"flex items-center justify-between"},Ge={class:"text-xs text-slate-400"},Ue={key:0,class:"flex items-center justify-center py-8"},qe={key:1,class:"space-y-4 max-h-[400px] overflow-y-auto p-4 bg-slate-900/30 rounded-xl border border-slate-700/50"},Ee={class:"flex items-center justify-between sticky top-0 bg-slate-900/90 backdrop-blur py-2 -mx-2 px-2"},Ie={class:"text-sm font-semibold text-amber-400 uppercase tracking-wider"},ze=["onClick"],He={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2"},Qe=["value"],Ze={class:"text-sm text-slate-300"},Je={class:"flex items-center justify-end gap-3 p-6 border-t border-slate-700 bg-slate-800/50 shrink-0"},Ke=["disabled"],Oe={__name:"RolesView",setup(D){const m=oe(),C=c([]),R=c(!1),h=c(null),b=c(""),g=c(!1),v=c(null),r=c({name:"",permissions:[]}),_=c(!1),N=c({}),V=c(!0),F=T(()=>N.value),B=T(()=>b.value?C.value.filter(o=>o.name.toLowerCase().includes(b.value.toLowerCase())):C.value);Q(()=>{j(),P()});const j=async()=>{var o,s;R.value=!0,h.value=null;try{const t=await f.get("/admin/roles");C.value=t.data}catch(t){h.value=((s=(o=t.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to load roles"}finally{R.value=!1}},P=async()=>{try{const o=await f.get("/admin/permissions");N.value=o.data}catch(o){console.error("Failed to load permissions:",o)}finally{V.value=!1}},A=()=>{v.value=null,r.value={name:"",permissions:[]},g.value=!0},G=o=>{var s;v.value=o,r.value={name:o.name,permissions:((s=o.permissions)==null?void 0:s.map(t=>t.name))||[]},g.value=!0},y=()=>{g.value=!1,v.value=null,r.value={name:"",permissions:[]}},U=async()=>{var o,s;if(!r.value.name){m.error("Role name is required");return}_.value=!0;try{v.value?(await f.patch(`/admin/roles/${v.value.id}`,r.value),m.success("Role updated")):(await f.post("/admin/roles",r.value),m.success("Role created")),y(),j()}catch(t){m.error(((s=(o=t.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to save role")}finally{_.value=!1}},q=async o=>{var s,t;if(confirm(`Delete role "${o.name}"?`))try{await f.delete(`/admin/roles/${o.id}`),m.success("Role deleted"),j()}catch(d){m.error(((t=(s=d.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to delete role")}},E=(o,s)=>{const t=s.map(n=>n.name);t.every(n=>r.value.permissions.includes(n))?r.value.permissions=r.value.permissions.filter(n=>!t.includes(n)):r.value.permissions=[...new Set([...r.value.permissions,...t])]},I=(o,s)=>s.every(t=>r.value.permissions.includes(t.name)),z=o=>o?new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A";return(o,s)=>(a(),l("div",re,[e("div",ne,[e("div",ie,[u(p(Z),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),$(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>b.value=t),type:"text",placeholder:"Search roles...",class:"w-full pl-10 pr-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50 transition-all"},null,512),[[L,b.value]])]),e("button",{onClick:A,class:"inline-flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white rounded-xl font-medium shadow-lg shadow-amber-500/20 transition-all"},[u(p(le),{class:"w-5 h-5"}),s[3]||(s[3]=J(" Create Role ",-1))])]),R.value?(a(),l("div",de,[...s[4]||(s[4]=[e("div",{class:"flex flex-col items-center justify-center"},[e("div",{class:"w-12 h-12 border-4 border-amber-500/30 border-t-amber-500 rounded-full animate-spin mb-4"}),e("p",{class:"text-slate-400"},"Loading roles...")],-1)])])):h.value?(a(),l("div",ce,[e("div",ue,[u(p(K),{class:"w-6 h-6 text-red-400"}),e("p",me,i(h.value),1)])])):(a(),l("div",pe,[(a(!0),l(w,null,k(B.value,t=>{var d,n;return a(),l("div",{key:t.id,class:"group bg-slate-800/50 hover:bg-slate-800 backdrop-blur-sm rounded-2xl border border-slate-700/50 hover:border-slate-600/50 p-6 transition-all"},[e("div",ve,[e("div",xe,[e("div",be,[u(p(M),{class:"w-5 h-5 text-white"})]),e("div",null,[e("h3",fe,i(t.name),1),e("p",he,"Created "+i(z(t.created_at)),1)])]),e("div",ge,[e("button",{onClick:x=>G(t),class:"p-2 rounded-lg text-slate-400 hover:text-amber-400 hover:bg-slate-700/50 transition-colors"},[u(p(ae),{class:"w-4 h-4"})],8,_e),e("button",{onClick:x=>q(t),class:"p-2 rounded-lg text-slate-400 hover:text-red-400 hover:bg-red-500/10 transition-colors"},[u(p(ee),{class:"w-4 h-4"})],8,ye)])]),e("div",we,[e("div",ke,[s[5]||(s[5]=e("span",{class:"text-xs font-medium text-slate-400 uppercase tracking-wider"},"Permissions",-1)),e("span",Ce,i(((d=t.permissions)==null?void 0:d.length)||0)+" total",1)]),(n=t.permissions)!=null&&n.length?(a(),l("div",Re,[(a(!0),l(w,null,k(t.permissions.slice(0,6),x=>(a(),l("span",{key:x.id,class:"px-2 py-1 text-xs font-medium rounded-md bg-slate-700/50 text-slate-300"},i(x.name),1))),128)),t.permissions.length>6?(a(),l("span",je," +"+i(t.permissions.length-6)+" more ",1)):S("",!0)])):(a(),l("p",$e,"No permissions assigned"))])])}),128)),B.value.length===0?(a(),l("div",Se,[e("div",De,[u(p(M),{class:"w-8 h-8 text-slate-500"})]),s[6]||(s[6]=e("h3",{class:"text-lg font-medium text-white mb-2"},"No roles found",-1)),e("p",Ne,i(b.value?"Try adjusting your search query":"Create your first role to get started"),1)])):S("",!0)])),(a(),O(Y,{to:"body"},[u(X,{name:"modal"},{default:W(()=>[g.value?(a(),l("div",Ve,[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:y}),e("div",Be,[e("div",Le,[e("h2",Me,i(v.value?"Edit Role":"Create Role"),1),e("button",{onClick:y,class:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-700 transition-colors"},[u(p(se),{class:"w-5 h-5"})])]),e("div",Te,[e("div",Fe,[s[7]||(s[7]=e("label",{class:"block text-sm font-medium text-slate-300"},"Role Name",-1)),$(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>r.value.name=t),type:"text",placeholder:"e.g., moderator, support",class:"w-full px-4 py-3 bg-slate-900/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50 transition-all"},null,512),[[L,r.value.name]])]),e("div",Pe,[e("div",Ae,[s[8]||(s[8]=e("label",{class:"block text-sm font-medium text-slate-300"},"Permissions",-1)),e("span",Ge,i(r.value.permissions.length)+" selected",1)]),V.value?(a(),l("div",Ue,[...s[9]||(s[9]=[e("div",{class:"w-8 h-8 border-4 border-amber-500/30 border-t-amber-500 rounded-full animate-spin"},null,-1)])])):(a(),l("div",qe,[(a(!0),l(w,null,k(F.value,(t,d)=>(a(),l("div",{key:d,class:"space-y-2"},[e("div",Ee,[e("h4",Ie,i(d),1),e("button",{onClick:n=>E(d,t),type:"button",class:"text-xs text-slate-400 hover:text-white transition-colors"},i(I(d,t)?"Deselect All":"Select All"),9,ze)]),e("div",He,[(a(!0),l(w,null,k(t,n=>(a(),l("label",{key:n.id,class:"flex items-center gap-3 p-3 rounded-lg bg-slate-800/50 hover:bg-slate-700/50 cursor-pointer transition-colors"},[$(e("input",{type:"checkbox",value:n.name,"onUpdate:modelValue":s[2]||(s[2]=x=>r.value.permissions=x),class:"w-4 h-4 rounded border-slate-600 text-amber-500 focus:ring-amber-500 focus:ring-offset-0 bg-slate-700"},null,8,Qe),[[te,r.value.permissions]]),e("span",Ze,i(n.name),1)]))),128))])]))),128))]))])]),e("div",Je,[e("button",{onClick:y,class:"px-4 py-2.5 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-xl font-medium transition-colors"}," Cancel "),e("button",{onClick:U,disabled:_.value,class:"px-4 py-2.5 bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white rounded-xl font-medium shadow-lg shadow-amber-500/20 transition-all disabled:opacity-50"},i(_.value?"Saving...":v.value?"Save Changes":"Create Role"),9,Ke)])])])):S("",!0)]),_:1})]))]))}},Xe=H(Oe,[["__scopeId","data-v-8c6ad2c8"]]);export{Xe as default};
