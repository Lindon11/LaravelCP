import{_ as x,e as k,h as o,a as t,k as w,v as M,m as S,s as $,t as i,F as D,i as U,x as g,g as u,q as V,o as n,n as L}from"./index-C4YYZO6H.js";const A={class:"view-container"},F={class:"filters-row"},B={key:0,class:"loading"},E={key:1,class:"error"},N={key:2,class:"empty"},R={key:3,class:"data-table"},j=["onClick"],q={__name:"UserTimersView",setup(z){const d=u([]),m=u(!0),c=u(null),v=u(""),p=u(""),T=V(()=>d.value.filter(l=>{var s,r;const a=!v.value||((r=(s=l.user)==null?void 0:s.username)==null?void 0:r.toLowerCase().includes(v.value.toLowerCase())),e=!p.value||l.type===p.value;return a&&e})),h=async()=>{var l,a;m.value=!0,c.value=null;try{const e=await g.get("/admin/user-timers");d.value=e.data.data||e.data||[]}catch(e){c.value=((a=(l=e.response)==null?void 0:l.data)==null?void 0:a.message)||"Failed to load timers"}finally{m.value=!1}},b=async l=>{var a,e;if(confirm("Clear this timer?"))try{await g.delete(`/admin/user-timers/${l}`),d.value=d.value.filter(s=>s.id!==l)}catch(s){alert(((e=(a=s.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to clear timer")}},y=l=>new Date(l).toLocaleString(),C=l=>{const a=new Date,s=new Date(l)-a;if(s<=0)return"Expired";const r=Math.floor(s/(1e3*60*60)),f=Math.floor(s%(1e3*60*60)/(1e3*60)),_=Math.floor(s%(1e3*60)/1e3);return r>0?`${r}h ${f}m`:f>0?`${f}m ${_}s`:`${_}s`};return k(h),(l,a)=>(n(),o("div",A,[a[4]||(a[4]=t("div",{class:"view-header"},[t("h1",null,"User Timers"),t("p",{class:"subtitle"},"Monitor active user cooldowns and timers")],-1)),t("div",F,[w(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>v.value=e),type:"text",placeholder:"Search by username...",class:"search-input"},null,512),[[M,v.value]]),w(t("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>p.value=e),class:"filter-select"},[...a[2]||(a[2]=[$('<option value="" data-v-fd54a8c5>All Types</option><option value="crime" data-v-fd54a8c5>Crime Cooldown</option><option value="theft" data-v-fd54a8c5>Theft Cooldown</option><option value="gym" data-v-fd54a8c5>Gym Cooldown</option><option value="travel" data-v-fd54a8c5>Travel Cooldown</option><option value="jail" data-v-fd54a8c5>Jail Timer</option>',6)])],512),[[S,p.value]]),t("button",{onClick:h,class:"btn btn-secondary"}," ðŸ”„ Refresh ")]),m.value?(n(),o("div",B,"Loading timers...")):c.value?(n(),o("div",E,i(c.value),1)):d.value.length===0?(n(),o("div",N,"No active timers found.")):(n(),o("table",R,[a[3]||(a[3]=t("thead",null,[t("tr",null,[t("th",null,"User"),t("th",null,"Timer Type"),t("th",null,"Started At"),t("th",null,"Expires At"),t("th",null,"Remaining"),t("th",null,"Actions")])],-1)),t("tbody",null,[(n(!0),o(D,null,U(T.value,e=>{var s;return n(),o("tr",{key:e.id},[t("td",null,i(((s=e.user)==null?void 0:s.username)||e.user_id),1),t("td",null,[t("span",{class:L(["badge",e.type])},i(e.type),3)]),t("td",null,i(y(e.created_at)),1),t("td",null,i(y(e.expires_at)),1),t("td",null,i(C(e.expires_at)),1),t("td",null,[t("button",{onClick:r=>b(e.id),class:"btn btn-danger btn-sm"}," Clear ",8,j)])])}),128))])]))]))}},I=x(q,[["__scopeId","data-v-fd54a8c5"]]);export{I as default};
