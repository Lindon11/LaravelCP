import{I as _}from"./InstallerLayout-CvnopuhI.js";import{c as g,w as m,r as h,o as s,a as l,h as a,l as i,F as k,i as w,t as v,d as x,g as p,f as C}from"./index-B8U8MnUz.js";const I={class:"p-12"},S={key:0,class:"text-gray-300 mb-8"},B={key:1,class:"space-y-4 mb-8"},j={class:"flex items-center"},E={key:0,class:"w-6 h-6 rounded-full border-2 border-gray-500 mr-3"},F={key:1,class:"w-6 h-6 rounded-full border-2 border-purple-500 border-t-transparent animate-spin mr-3"},R={key:2,class:"w-6 h-6 rounded-full bg-green-500 flex items-center justify-center mr-3"},N={key:3,class:"w-6 h-6 rounded-full bg-red-500 flex items-center justify-center mr-3"},T={class:"text-white"},V={key:0,class:"text-green-400 text-sm"},L={key:1,class:"text-purple-400 text-sm"},P={key:2,class:"text-red-400 text-sm"},z={key:2,class:"bg-red-500/20 border border-red-500 rounded-lg p-4 mb-8"},D={class:"text-red-300"},q={key:3,class:"bg-green-500/20 border border-green-500 rounded-lg p-4 mb-8"},A={class:"flex justify-between pt-6"},G={key:1},M={__name:"Install",setup(H){const u=p(!1),o=p(!1),r=p(""),d=p([{id:1,label:"Clearing configuration cache",status:"pending"},{id:2,label:"Running database migrations",status:"pending"},{id:3,label:"Creating storage links",status:"pending"},{id:4,label:"Finalizing installation",status:"pending"}]),b=(c,t)=>{const n=d.value.find(e=>e.id===c);n&&(n.status=t)},f=async()=>{var c,t;u.value=!0,o.value=!1,r.value="",d.value.forEach(n=>{n.status="pending"});try{for(let n=0;n<d.value.length;n++){if(b(n+1,"running"),n===0)await new Promise(e=>setTimeout(e,1e3));else if(n===d.value.length-1){const e=await C.post("/install/install/process");if(!e.data.success)throw new Error(e.data.message)}else await new Promise(e=>setTimeout(e,1500));b(n+1,"completed")}o.value=!0}catch(n){r.value=((t=(c=n.response)==null?void 0:c.data)==null?void 0:t.message)||n.message||"Installation failed";const e=d.value.find(y=>y.status==="running");e&&(e.status="error")}finally{u.value=!1}};return(c,t)=>{const n=h("router-link");return s(),g(_,{"current-step":"install"},{default:m(()=>[l("div",I,[t[6]||(t[6]=l("h2",{class:"text-3xl font-bold text-white mb-6"},"Installation",-1)),!u.value&&!o.value?(s(),a("p",S," Ready to install? Click the button below to begin the installation process. ")):i("",!0),u.value||o.value?(s(),a("div",B,[(s(!0),a(k,null,w(d.value,e=>(s(),a("div",{key:e.id,class:"bg-white/5 rounded-lg p-4 flex items-center justify-between"},[l("div",j,[e.status==="pending"?(s(),a("div",E)):e.status==="running"?(s(),a("div",F)):e.status==="completed"?(s(),a("div",R,[...t[0]||(t[0]=[l("span",{class:"text-white text-xs"},"✓",-1)])])):e.status==="error"?(s(),a("div",N,[...t[1]||(t[1]=[l("span",{class:"text-white text-xs"},"✗",-1)])])):i("",!0),l("span",T,v(e.label),1)]),e.status==="completed"?(s(),a("span",V,"Completed")):e.status==="running"?(s(),a("span",L,"Running...")):e.status==="error"?(s(),a("span",P,"Failed")):i("",!0)]))),128))])):i("",!0),r.value?(s(),a("div",z,[t[2]||(t[2]=l("p",{class:"text-red-300 font-semibold mb-2"},"Installation Error:",-1)),l("p",D,v(r.value),1)])):i("",!0),o.value&&!r.value?(s(),a("div",q,[...t[3]||(t[3]=[l("p",{class:"text-green-300"},"✓ Installation completed successfully!",-1)])])):i("",!0),l("div",A,[!u.value&&!o.value?(s(),g(n,{key:0,to:"/install/setup-admin",class:"bg-gray-600 hover:bg-gray-700 text-white font-semibold px-6 py-3 rounded-lg transition"},{default:m(()=>[...t[4]||(t[4]=[x(" ← Back ",-1)])]),_:1})):(s(),a("div",G)),!u.value&&!o.value?(s(),a("button",{key:2,onClick:f,class:"bg-purple-600 hover:bg-purple-700 text-white font-semibold px-6 py-3 rounded-lg transition"}," Start Installation ")):o.value&&!r.value?(s(),g(n,{key:3,to:"/install/complete",class:"bg-purple-600 hover:bg-purple-700 text-white font-semibold px-6 py-3 rounded-lg transition"},{default:m(()=>[...t[5]||(t[5]=[x(" Continue → ",-1)])]),_:1})):r.value?(s(),a("button",{key:4,onClick:f,class:"bg-purple-600 hover:bg-purple-700 text-white font-semibold px-6 py-3 rounded-lg transition"}," Retry Installation ")):i("",!0)])])]),_:1})}}};export{M as default};
