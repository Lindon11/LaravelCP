import{o as n,h as i,a as t,_ as J,e as K,x as F,F as _,i as w,b as g,z as p,G as X,k as V,v as Y,m as L,s as ee,D as te,d as h,l as y,ag as ae,t as d,w as se,a2 as re,A as le,B as N,g as m,q as B,u as oe,n as v,c as ne,U as ie,ah as de,a4 as ue,ai as ce,aj as ge,Q as pe,H as ve}from"./index-C4YYZO6H.js";import{r as be}from"./TagIcon-sf7a1mfJ.js";import{r as me}from"./CheckCircleIcon-tmHoli13.js";function fe(R,j){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 13.5h3.86a2.25 2.25 0 0 1 2.012 1.244l.256.512a2.25 2.25 0 0 0 2.013 1.244h3.218a2.25 2.25 0 0 0 2.013-1.244l.256-.512a2.25 2.25 0 0 1 2.013-1.244h3.859m-19.5.338V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18v-4.162c0-.224-.034-.447-.1-.661L19.24 5.338a2.25 2.25 0 0 0-2.15-1.588H6.911a2.25 2.25 0 0 0-2.15 1.588L2.35 13.177a2.25 2.25 0 0 0-.1.661Z"})])}const xe={class:"space-y-6"},he={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},_e=["onClick"],we={class:"flex items-center justify-between"},ye={class:"flex flex-col lg:flex-row items-start lg:items-center gap-4"},ke={class:"relative flex-1 w-full lg:max-w-md"},Ce={class:"flex flex-wrap items-center gap-3"},$e=["value"],Ve={key:0,class:"rounded-2xl bg-slate-800/50 backdrop-blur border border-slate-700/50 p-12"},Be={key:1,class:"rounded-2xl bg-slate-800/50 backdrop-blur border border-slate-700/50 p-12"},je={class:"flex flex-col items-center justify-center"},Me={class:"w-16 h-16 rounded-2xl bg-slate-700/30 flex items-center justify-center mb-4"},Te={class:"text-slate-400 text-center max-w-sm"},Ue={key:2,class:"space-y-3"},Ae=["onClick"],De={class:"flex items-start gap-4 pl-3"},Se={class:"flex-1 min-w-0"},Fe={class:"flex items-center gap-3 mb-2"},Le={class:"text-xs font-mono text-slate-500"},Ne={class:"text-white font-medium group-hover:text-amber-400 transition-colors truncate mb-2"},Re={class:"flex flex-wrap items-center gap-4 text-sm text-slate-400"},He={class:"inline-flex items-center gap-1.5"},Ie={class:"inline-flex items-center gap-1.5"},Pe={key:0,class:"inline-flex items-center gap-1.5"},ze={key:1,class:"inline-flex items-center gap-1.5"},Ge={class:"flex items-center gap-3"},Oe={key:0,class:"flex items-center gap-2"},We={class:"w-9 h-9 rounded-full bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center text-white text-sm font-semibold"},qe={key:1,class:"flex items-center gap-2 text-slate-500"},Ee={class:"w-9 h-9 rounded-full bg-slate-700/50 border-2 border-dashed border-slate-600 flex items-center justify-center"},Qe={key:3,class:"flex items-center justify-between"},Ze={class:"text-sm text-slate-400"},Je={class:"flex items-center gap-2"},Ke=["disabled"],Xe={class:"flex items-center gap-1"},Ye=["onClick"],et=["disabled"],tt={__name:"TicketListView",setup(R){const j=oe(),k=m([]),C=m(!1),f=m({open:0,waiting:0,urgent:0,closed:0}),s=m({search:"",status:"",priority:"",assigned:""}),l=m({current_page:1,last_page:1,per_page:15,total:0}),M=m([]);let T=null;const H={open:{badge:"bg-blue-500/20 text-blue-400"},waiting_response:{badge:"bg-amber-500/20 text-amber-400"},answered:{badge:"bg-emerald-500/20 text-emerald-400"},closed:{badge:"bg-slate-600/50 text-slate-400"}},U={urgent:{bar:"bg-red-500",badge:"bg-red-500/20 text-red-400"},high:{bar:"bg-orange-500",badge:"bg-orange-500/20 text-orange-400"},medium:{bar:"bg-amber-500",badge:"bg-amber-500/20 text-amber-400"},low:{bar:"bg-emerald-500",badge:"bg-emerald-500/20 text-emerald-400"}},I=B(()=>[{key:"open",label:"Open",value:f.value.open,filterValue:"open",icon:fe,iconBg:"bg-blue-500/20",iconColor:"text-blue-400",textColor:"text-blue-400",activeBg:"from-blue-500 to-blue-600",activeRing:"ring-blue-500"},{key:"waiting",label:"Waiting",value:f.value.waiting,filterValue:"waiting_response",icon:pe,iconBg:"bg-amber-500/20",iconColor:"text-amber-400",textColor:"text-amber-400",activeBg:"from-amber-500 to-orange-600",activeRing:"ring-amber-500"},{key:"urgent",label:"Urgent",value:f.value.urgent,filterValue:"urgent",icon:ve,iconBg:"bg-red-500/20",iconColor:"text-red-400",textColor:"text-red-400",activeBg:"from-red-500 to-red-600",activeRing:"ring-red-500"},{key:"closed",label:"Closed",value:f.value.closed,filterValue:"closed",icon:me,iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",textColor:"text-emerald-400",activeBg:"from-emerald-500 to-emerald-600",activeRing:"ring-emerald-500"}]),A=B(()=>s.value.search||s.value.status||s.value.priority||s.value.assigned),P=B(()=>{const r=[],a=l.value.current_page,e=l.value.last_page,c=2;for(let u=Math.max(1,a-c);u<=Math.min(e,a+c);u++)r.push(u);return r});K(()=>{b(),W()});const b=async()=>{var r,a,e,c;C.value=!0;try{const u={page:l.value.current_page,search:s.value.search,status:s.value.status==="urgent"?"":s.value.status,priority:s.value.status==="urgent"?"urgent":s.value.priority,assigned:s.value.assigned};s.value.assigned&&!["unassigned","me"].includes(s.value.assigned)&&(u.user_id=s.value.assigned,u.assigned="");const o=await F.get("/admin/support/tickets",{params:u});k.value=o.data.tickets||o.data.data||o.data,o.data.pagination?l.value=o.data.pagination:(o.data.meta||o.data.current_page)&&(l.value={current_page:((r=o.data.meta)==null?void 0:r.current_page)||o.data.current_page,last_page:((a=o.data.meta)==null?void 0:a.last_page)||o.data.last_page,per_page:((e=o.data.meta)==null?void 0:e.per_page)||o.data.per_page||15,total:((c=o.data.meta)==null?void 0:c.total)||o.data.total}),o.data.stats&&(f.value=o.data.stats)}catch(u){console.error("Failed to fetch tickets:",u)}finally{C.value=!1}},z=()=>{clearTimeout(T),T=setTimeout(()=>{l.value.current_page=1,b()},300)},G=(r,a)=>{a==="urgent"?(s.value.status="urgent",s.value.priority=""):s.value[r]=s.value[r]===a?"":a,l.value.current_page=1,b()},O=()=>{l.value.current_page=1,b()},W=async()=>{try{const r=await F.get("/admin/support/tickets/staff/users");M.value=r.data.users||[]}catch(r){console.error("Failed to fetch staff users:",r)}},q=()=>{s.value={search:"",status:"",priority:"",assigned:""},l.value.current_page=1,b()},$=r=>{r>=1&&r<=l.value.last_page&&(l.value.current_page=r,b())},E=r=>j.push(`/tickets/${r}`),Q=r=>({open:"Open",waiting_response:"Waiting",answered:"Answered",closed:"Closed"})[r]||r,Z=r=>{if(!r)return"N/A";const a=new Date(r),c=new Date-a,u=Math.floor(c/6e4),o=Math.floor(c/36e5),x=Math.floor(c/864e5);return u<60?`${u}m ago`:o<24?`${o}h ago`:x<7?`${x}d ago`:a.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return(r,a)=>(n(),i("div",xe,[t("div",he,[(n(!0),i(_,null,w(I.value,e=>(n(),i("button",{key:e.key,onClick:c=>G("status",e.filterValue),class:v(["relative overflow-hidden rounded-2xl p-5 text-left transition-all group",s.value.status===e.filterValue?"bg-gradient-to-br ring-2 ring-offset-2 ring-offset-slate-900 "+e.activeRing+" "+e.activeBg:"bg-slate-800/50 hover:bg-slate-800 border border-slate-700/50 hover:border-slate-600/50"])},[t("div",we,[t("div",null,[t("p",{class:v(["text-3xl font-bold",s.value.status===e.filterValue?"text-white":e.textColor])},d(e.value),3),t("p",{class:v(["text-sm font-medium mt-1",s.value.status===e.filterValue?"text-white/80":"text-slate-400"])},d(e.label),3)]),t("div",{class:v(["p-3 rounded-xl",s.value.status===e.filterValue?"bg-white/20":e.iconBg])},[(n(),ne(ie(e.icon),{class:v(["w-6 h-6",s.value.status===e.filterValue?"text-white":e.iconColor])},null,8,["class"]))],2)])],10,_e))),128))]),t("div",ye,[t("div",ke,[g(p(X),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),V(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.value.search=e),type:"text",placeholder:"Search tickets by subject or ID...",onInput:z,class:"w-full pl-12 pr-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50 transition-all"},null,544),[[Y,s.value.search]])]),t("div",Ce,[V(t("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>s.value.priority=e),onChange:b,class:"px-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all"},[...a[5]||(a[5]=[ee('<option value="" data-v-4b896786>All Priorities</option><option value="urgent" data-v-4b896786>ðŸ”´ Urgent</option><option value="high" data-v-4b896786>ðŸŸ  High</option><option value="medium" data-v-4b896786>ðŸŸ¡ Medium</option><option value="low" data-v-4b896786>ðŸŸ¢ Low</option>',5)])],544),[[L,s.value.priority]]),V(t("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>s.value.assigned=e),onChange:O,class:"px-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all"},[a[6]||(a[6]=t("option",{value:""},"All Tickets",-1)),a[7]||(a[7]=t("option",{value:"unassigned"},"Unassigned",-1)),a[8]||(a[8]=t("option",{value:"me"},"Assigned to Me",-1)),a[9]||(a[9]=t("option",{disabled:""},"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€",-1)),(n(!0),i(_,null,w(M.value,e=>(n(),i("option",{key:e.id,value:e.id},d(e.username),9,$e))),128))],544),[[L,s.value.assigned]]),A.value?(n(),i("button",{key:0,onClick:q,class:"inline-flex items-center gap-2 px-4 py-3 text-slate-400 hover:text-white transition-colors"},[g(p(te),{class:"w-4 h-4"}),a[10]||(a[10]=h(" Clear ",-1))])):y("",!0)])]),C.value?(n(),i("div",Ve,[...a[11]||(a[11]=[t("div",{class:"flex flex-col items-center justify-center"},[t("div",{class:"w-12 h-12 border-4 border-amber-500/30 border-t-amber-500 rounded-full animate-spin mb-4"}),t("p",{class:"text-slate-400"},"Loading tickets...")],-1)])])):k.value.length===0?(n(),i("div",Be,[t("div",je,[t("div",Me,[g(p(ae),{class:"w-8 h-8 text-slate-500"})]),a[12]||(a[12]=t("h3",{class:"text-lg font-semibold text-white mb-2"},"No tickets found",-1)),t("p",Te,d(A.value?"Try adjusting your filters":"All support tickets will appear here"),1)])])):(n(),i("div",Ue,[g(re,{name:"list"},{default:se(()=>[(n(!0),i(_,null,w(k.value,e=>{var c,u,o,x,D,S;return n(),i("div",{key:e.id,onClick:at=>E(e.id),class:"group relative bg-slate-800/50 hover:bg-slate-800 backdrop-blur-sm rounded-2xl border border-slate-700/50 hover:border-slate-600/50 p-5 cursor-pointer transition-all"},[t("div",{class:v(["absolute left-0 top-0 bottom-0 w-1 rounded-l-2xl",((c=U[e.priority])==null?void 0:c.bar)||"bg-slate-600"])},null,2),t("div",De,[t("div",Se,[t("div",Fe,[t("span",Le,"#"+d(e.id),1),t("span",{class:v(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium",((u=H[e.status])==null?void 0:u.badge)||"bg-slate-700 text-slate-300"])},d(Q(e.status)),3),t("span",{class:v(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium",((o=U[e.priority])==null?void 0:o.badge)||"bg-slate-700 text-slate-300"])},d(e.priority),3)]),t("h3",Ne,d(e.subject),1),t("div",Re,[t("span",He,[g(p(de),{class:"w-4 h-4"}),h(" "+d(((x=e.user)==null?void 0:x.username)||"Unknown"),1)]),t("span",Ie,[g(p(ue),{class:"w-4 h-4"}),h(" "+d(Z(e.updated_at)),1)]),e.messages_count?(n(),i("span",Pe,[g(p(ce),{class:"w-4 h-4"}),h(" "+d(e.messages_count)+" messages ",1)])):y("",!0),e.category?(n(),i("span",ze,[g(p(be),{class:"w-4 h-4"}),h(" "+d(e.category.name),1)])):y("",!0)])]),t("div",Ge,[e.assigned_user?(n(),i("div",Oe,[t("div",We,d((S=(D=e.assigned_user.username)==null?void 0:D.charAt(0))==null?void 0:S.toUpperCase()),1)])):(n(),i("div",qe,[t("div",Ee,[g(p(ge),{class:"w-4 h-4"})])])),g(p(N),{class:"w-5 h-5 text-slate-600 group-hover:text-slate-400 transition-colors"})])])],8,Ae)}),128))]),_:1})])),l.value.last_page>1?(n(),i("div",Qe,[t("p",Ze," Showing "+d((l.value.current_page-1)*l.value.per_page+1)+" to "+d(Math.min(l.value.current_page*l.value.per_page,l.value.total))+" of "+d(l.value.total)+" tickets ",1),t("div",Je,[t("button",{onClick:a[3]||(a[3]=e=>$(l.value.current_page-1)),disabled:l.value.current_page===1,class:"p-2 rounded-lg bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[g(p(le),{class:"w-5 h-5"})],8,Ke),t("div",Xe,[(n(!0),i(_,null,w(P.value,e=>(n(),i("button",{key:e,onClick:c=>$(e),class:v(["w-10 h-10 rounded-lg text-sm font-medium transition-colors",e===l.value.current_page?"bg-gradient-to-r from-amber-500 to-orange-600 text-white":"bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700"])},d(e),11,Ye))),128))]),t("button",{onClick:a[4]||(a[4]=e=>$(l.value.current_page+1)),disabled:l.value.current_page===l.value.last_page,class:"p-2 rounded-lg bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[g(p(N),{class:"w-5 h-5"})],8,et)])])):y("",!0)]))}},ot=J(tt,[["__scopeId","data-v-4b896786"]]);export{ot as default};
