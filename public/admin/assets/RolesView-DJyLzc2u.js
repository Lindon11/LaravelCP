import{_ as I,e as J,x as f,h as l,a as e,b as u,z as m,I as K,k as $,v as M,d as Q,J as H,t as i,F as w,i as k,K as T,l as S,c as O,w as W,T as X,L as Y,g as c,q as F,o as a,E as Z,D as ee,M as se,y as te}from"./index-BYO5IqdQ.js";import{r as oe}from"./PlusIcon-BW5dMiao.js";import{r as ae}from"./PencilIcon-D6yR-ZU6.js";const le={class:"space-y-6"},re={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4"},ne={class:"relative w-full sm:w-80"},ie={key:0,class:"rounded-2xl bg-slate-800/50 backdrop-blur border border-slate-700/50 p-12"},de={key:1,class:"rounded-2xl bg-red-500/10 border border-red-500/30 p-6"},ce={class:"flex items-center gap-3"},ue={class:"text-red-400 font-medium"},me={key:2,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6"},pe={class:"flex items-start justify-between mb-4"},ve={class:"flex items-center gap-3"},xe={class:"w-10 h-10 rounded-xl bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center"},be={class:"font-semibold text-white group-hover:text-amber-400 transition-colors"},fe={class:"text-xs text-slate-400"},he={class:"flex items-center gap-1"},ge=["onClick"],_e=["onClick"],ye={class:"space-y-3"},we={class:"flex items-center justify-between"},ke={class:"text-xs font-medium text-slate-500"},Ce={key:0,class:"flex flex-wrap gap-1.5"},Re={key:0,class:"px-2 py-1 text-xs font-medium rounded-md bg-amber-500/20 text-amber-400"},je={key:1,class:"text-sm text-slate-500 italic"},$e={key:0,class:"col-span-full flex flex-col items-center justify-center py-12"},Se={class:"w-16 h-16 rounded-2xl bg-slate-700/30 flex items-center justify-center mb-4"},De={class:"text-slate-400 text-center max-w-sm"},Ne={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Ve={class:"relative bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col"},Me={class:"flex items-center justify-between p-6 border-b border-slate-700 shrink-0"},Te={class:"text-lg font-bold text-white"},Fe={class:"p-6 overflow-y-auto flex-1 space-y-6"},Le={class:"space-y-2"},Be={class:"space-y-3"},Pe={class:"flex items-center justify-between"},Ue={class:"text-xs text-slate-400"},qe={key:0,class:"flex items-center justify-center py-8"},Ae={key:1,class:"space-y-4 max-h-[400px] overflow-y-auto p-4 bg-slate-900/30 rounded-xl border border-slate-700/50"},Ee={class:"flex items-center justify-between sticky top-0 bg-slate-900/90 backdrop-blur py-2 -mx-2 px-2"},Ge={class:"text-sm font-semibold text-amber-400 uppercase tracking-wider"},ze=["onClick"],Ie={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2"},Je=["value"],Ke={class:"text-sm text-slate-300"},Qe={class:"flex items-center justify-end gap-3 p-6 border-t border-slate-700 bg-slate-800/50 shrink-0"},He=["disabled"],Oe={__name:"RolesView",setup(We){const v=te(),C=c([]),R=c(!1),h=c(null),b=c(""),g=c(!1),p=c(null),r=c({name:"",permissions:[]}),_=c(!1),D=c({}),N=c(!0),L=F(()=>D.value),V=F(()=>b.value?C.value.filter(o=>o.name.toLowerCase().includes(b.value.toLowerCase())):C.value);J(()=>{j(),B()});const j=async()=>{var o,s;R.value=!0,h.value=null;try{const t=await f.get("/admin/roles");C.value=t.data}catch(t){h.value=((s=(o=t.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to load roles"}finally{R.value=!1}},B=async()=>{try{const o=await f.get("/admin/permissions");D.value=o.data}catch(o){console.error("Failed to load permissions:",o)}finally{N.value=!1}},P=()=>{p.value=null,r.value={name:"",permissions:[]},g.value=!0},U=o=>{var s;p.value=o,r.value={name:o.name,permissions:((s=o.permissions)==null?void 0:s.map(t=>t.name))||[]},g.value=!0},y=()=>{g.value=!1,p.value=null,r.value={name:"",permissions:[]}},q=async()=>{var o,s;if(!r.value.name){v.error("Role name is required");return}_.value=!0;try{p.value?(await f.patch(`/admin/roles/${p.value.id}`,r.value),v.success("Role updated")):(await f.post("/admin/roles",r.value),v.success("Role created")),y(),j()}catch(t){v.error(((s=(o=t.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to save role")}finally{_.value=!1}},A=async o=>{var s,t;if(confirm(`Delete role "${o.name}"?`))try{await f.delete(`/admin/roles/${o.id}`),v.success("Role deleted"),j()}catch(d){v.error(((t=(s=d.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to delete role")}},E=(o,s)=>{const t=s.map(n=>n.name);t.every(n=>r.value.permissions.includes(n))?r.value.permissions=r.value.permissions.filter(n=>!t.includes(n)):r.value.permissions=[...new Set([...r.value.permissions,...t])]},G=(o,s)=>s.every(t=>r.value.permissions.includes(t.name)),z=o=>o?new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A";return(o,s)=>(a(),l("div",le,[e("div",re,[e("div",ne,[u(m(K),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),$(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>b.value=t),type:"text",placeholder:"Search roles...",class:"w-full pl-10 pr-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50 transition-all"},null,512),[[M,b.value]])]),e("button",{onClick:P,class:"inline-flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white rounded-xl font-medium shadow-lg shadow-amber-500/20 transition-all"},[u(m(oe),{class:"w-5 h-5"}),s[3]||(s[3]=Q(" Create Role ",-1))])]),R.value?(a(),l("div",ie,[...s[4]||(s[4]=[e("div",{class:"flex flex-col items-center justify-center"},[e("div",{class:"w-12 h-12 border-4 border-amber-500/30 border-t-amber-500 rounded-full animate-spin mb-4"}),e("p",{class:"text-slate-400"},"Loading roles...")],-1)])])):h.value?(a(),l("div",de,[e("div",ce,[u(m(H),{class:"w-6 h-6 text-red-400"}),e("p",ue,i(h.value),1)])])):(a(),l("div",me,[(a(!0),l(w,null,k(V.value,t=>{var d,n;return a(),l("div",{key:t.id,class:"group bg-slate-800/50 hover:bg-slate-800 backdrop-blur-sm rounded-2xl border border-slate-700/50 hover:border-slate-600/50 p-6 transition-all"},[e("div",pe,[e("div",ve,[e("div",xe,[u(m(T),{class:"w-5 h-5 text-white"})]),e("div",null,[e("h3",be,i(t.name),1),e("p",fe,"Created "+i(z(t.created_at)),1)])]),e("div",he,[e("button",{onClick:x=>U(t),class:"p-2 rounded-lg text-slate-400 hover:text-amber-400 hover:bg-slate-700/50 transition-colors"},[u(m(ae),{class:"w-4 h-4"})],8,ge),e("button",{onClick:x=>A(t),class:"p-2 rounded-lg text-slate-400 hover:text-red-400 hover:bg-red-500/10 transition-colors"},[u(m(Z),{class:"w-4 h-4"})],8,_e)])]),e("div",ye,[e("div",we,[s[5]||(s[5]=e("span",{class:"text-xs font-medium text-slate-400 uppercase tracking-wider"},"Permissions",-1)),e("span",ke,i(((d=t.permissions)==null?void 0:d.length)||0)+" total",1)]),(n=t.permissions)!=null&&n.length?(a(),l("div",Ce,[(a(!0),l(w,null,k(t.permissions.slice(0,6),x=>(a(),l("span",{key:x.id,class:"px-2 py-1 text-xs font-medium rounded-md bg-slate-700/50 text-slate-300"},i(x.name),1))),128)),t.permissions.length>6?(a(),l("span",Re," +"+i(t.permissions.length-6)+" more ",1)):S("",!0)])):(a(),l("p",je,"No permissions assigned"))])])}),128)),V.value.length===0?(a(),l("div",$e,[e("div",Se,[u(m(T),{class:"w-8 h-8 text-slate-500"})]),s[6]||(s[6]=e("h3",{class:"text-lg font-medium text-white mb-2"},"No roles found",-1)),e("p",De,i(b.value?"Try adjusting your search query":"Create your first role to get started"),1)])):S("",!0)])),(a(),O(Y,{to:"body"},[u(X,{name:"modal"},{default:W(()=>[g.value?(a(),l("div",Ne,[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:y}),e("div",Ve,[e("div",Me,[e("h2",Te,i(p.value?"Edit Role":"Create Role"),1),e("button",{onClick:y,class:"p-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-700 transition-colors"},[u(m(ee),{class:"w-5 h-5"})])]),e("div",Fe,[e("div",Le,[s[7]||(s[7]=e("label",{class:"block text-sm font-medium text-slate-300"},"Role Name",-1)),$(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>r.value.name=t),type:"text",placeholder:"e.g., moderator, support",class:"w-full px-4 py-3 bg-slate-900/50 border border-slate-600/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50 transition-all"},null,512),[[M,r.value.name]])]),e("div",Be,[e("div",Pe,[s[8]||(s[8]=e("label",{class:"block text-sm font-medium text-slate-300"},"Permissions",-1)),e("span",Ue,i(r.value.permissions.length)+" selected",1)]),N.value?(a(),l("div",qe,[...s[9]||(s[9]=[e("div",{class:"w-8 h-8 border-4 border-amber-500/30 border-t-amber-500 rounded-full animate-spin"},null,-1)])])):(a(),l("div",Ae,[(a(!0),l(w,null,k(L.value,(t,d)=>(a(),l("div",{key:d,class:"space-y-2"},[e("div",Ee,[e("h4",Ge,i(d),1),e("button",{onClick:n=>E(d,t),type:"button",class:"text-xs text-slate-400 hover:text-white transition-colors"},i(G(d,t)?"Deselect All":"Select All"),9,ze)]),e("div",Ie,[(a(!0),l(w,null,k(t,n=>(a(),l("label",{key:n.id,class:"flex items-center gap-3 p-3 rounded-lg bg-slate-800/50 hover:bg-slate-700/50 cursor-pointer transition-colors"},[$(e("input",{type:"checkbox",value:n.name,"onUpdate:modelValue":s[2]||(s[2]=x=>r.value.permissions=x),class:"w-4 h-4 rounded border-slate-600 text-amber-500 focus:ring-amber-500 focus:ring-offset-0 bg-slate-700"},null,8,Je),[[se,r.value.permissions]]),e("span",Ke,i(n.name),1)]))),128))])]))),128))]))])]),e("div",Qe,[e("button",{onClick:y,class:"px-4 py-2.5 bg-slate-700 hover:bg-slate-600 text-slate-300 rounded-xl font-medium transition-colors"}," Cancel "),e("button",{onClick:q,disabled:_.value,class:"px-4 py-2.5 bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white rounded-xl font-medium shadow-lg shadow-amber-500/20 transition-all disabled:opacity-50"},i(_.value?"Saving...":p.value?"Save Changes":"Create Role"),9,He)])])])):S("",!0)]),_:1})]))]))}},es=I(Oe,[["__scopeId","data-v-4cc7fa23"]]);export{es as default};
