import{o as n,h as i,a as t,_ as K,e as Q,x as F,F as _,i as w,b as g,z as p,I as X,k as $,v as Y,m as L,s as ee,D as te,d as h,l as y,af as ae,t as d,w as se,a2 as re,A as oe,B as N,g as b,q as B,u as le,n as v,c as ne,V as ie,ag as de,a4 as ue,ah as ce,ai as ge,J as pe}from"./index-BYO5IqdQ.js";import{r as ve}from"./TagIcon-CnNesyBh.js";import{r as me}from"./ClockIcon-izMteWNv.js";import{r as be}from"./CheckCircleIcon-RcgkcFB8.js";function fe(R,M){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 13.5h3.86a2.25 2.25 0 0 1 2.012 1.244l.256.512a2.25 2.25 0 0 0 2.013 1.244h3.218a2.25 2.25 0 0 0 2.013-1.244l.256-.512a2.25 2.25 0 0 1 2.013-1.244h3.859m-19.5.338V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18v-4.162c0-.224-.034-.447-.1-.661L19.24 5.338a2.25 2.25 0 0 0-2.15-1.588H6.911a2.25 2.25 0 0 0-2.15 1.588L2.35 13.177a2.25 2.25 0 0 0-.1.661Z"})])}const xe={class:"space-y-6"},he={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},_e=["onClick"],we={class:"flex items-center justify-between"},ye={class:"flex flex-col lg:flex-row items-start lg:items-center gap-4"},ke={class:"relative flex-1 w-full lg:max-w-md"},Ce={class:"flex flex-wrap items-center gap-3"},Ve=["value"],$e={key:0,class:"rounded-2xl bg-slate-800/50 backdrop-blur border border-slate-700/50 p-12"},Be={key:1,class:"rounded-2xl bg-slate-800/50 backdrop-blur border border-slate-700/50 p-12"},Me={class:"flex flex-col items-center justify-center"},Te={class:"w-16 h-16 rounded-2xl bg-slate-700/30 flex items-center justify-center mb-4"},je={class:"text-slate-400 text-center max-w-sm"},Ae={key:2,class:"space-y-3"},Ue=["onClick"],De={class:"flex items-start gap-4 pl-3"},Se={class:"flex-1 min-w-0"},Fe={class:"flex items-center gap-3 mb-2"},Le={class:"text-xs font-mono text-slate-500"},Ne={class:"text-white font-medium group-hover:text-amber-400 transition-colors truncate mb-2"},Re={class:"flex flex-wrap items-center gap-4 text-sm text-slate-400"},Ie={class:"inline-flex items-center gap-1.5"},Pe={class:"inline-flex items-center gap-1.5"},ze={key:0,class:"inline-flex items-center gap-1.5"},He={key:1,class:"inline-flex items-center gap-1.5"},Oe={class:"flex items-center gap-3"},We={key:0,class:"flex items-center gap-2"},qe={class:"w-9 h-9 rounded-full bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center text-white text-sm font-semibold"},Ee={key:1,class:"flex items-center gap-2 text-slate-500"},Ge={class:"w-9 h-9 rounded-full bg-slate-700/50 border-2 border-dashed border-slate-600 flex items-center justify-center"},Je={key:3,class:"flex items-center justify-between"},Ze={class:"text-sm text-slate-400"},Ke={class:"flex items-center gap-2"},Qe=["disabled"],Xe={class:"flex items-center gap-1"},Ye=["onClick"],et=["disabled"],tt={__name:"TicketListView",setup(R){const M=le(),k=b([]),C=b(!1),f=b({open:0,waiting:0,urgent:0,closed:0}),s=b({search:"",status:"",priority:"",assigned:""}),o=b({current_page:1,last_page:1,per_page:15,total:0}),T=b([]);let j=null;const I={open:{badge:"bg-blue-500/20 text-blue-400"},waiting_response:{badge:"bg-amber-500/20 text-amber-400"},answered:{badge:"bg-emerald-500/20 text-emerald-400"},closed:{badge:"bg-slate-600/50 text-slate-400"}},A={urgent:{bar:"bg-red-500",badge:"bg-red-500/20 text-red-400"},high:{bar:"bg-orange-500",badge:"bg-orange-500/20 text-orange-400"},medium:{bar:"bg-amber-500",badge:"bg-amber-500/20 text-amber-400"},low:{bar:"bg-emerald-500",badge:"bg-emerald-500/20 text-emerald-400"}},P=B(()=>[{key:"open",label:"Open",value:f.value.open,filterValue:"open",icon:fe,iconBg:"bg-blue-500/20",iconColor:"text-blue-400",textColor:"text-blue-400",activeBg:"from-blue-500 to-blue-600",activeRing:"ring-blue-500"},{key:"waiting",label:"Waiting",value:f.value.waiting,filterValue:"waiting_response",icon:me,iconBg:"bg-amber-500/20",iconColor:"text-amber-400",textColor:"text-amber-400",activeBg:"from-amber-500 to-orange-600",activeRing:"ring-amber-500"},{key:"urgent",label:"Urgent",value:f.value.urgent,filterValue:"urgent",icon:pe,iconBg:"bg-red-500/20",iconColor:"text-red-400",textColor:"text-red-400",activeBg:"from-red-500 to-red-600",activeRing:"ring-red-500"},{key:"closed",label:"Closed",value:f.value.closed,filterValue:"closed",icon:be,iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",textColor:"text-emerald-400",activeBg:"from-emerald-500 to-emerald-600",activeRing:"ring-emerald-500"}]),U=B(()=>s.value.search||s.value.status||s.value.priority||s.value.assigned),z=B(()=>{const r=[],a=o.value.current_page,e=o.value.last_page,c=2;for(let u=Math.max(1,a-c);u<=Math.min(e,a+c);u++)r.push(u);return r});Q(()=>{m(),q()});const m=async()=>{var r,a,e,c;C.value=!0;try{const u={page:o.value.current_page,search:s.value.search,status:s.value.status==="urgent"?"":s.value.status,priority:s.value.status==="urgent"?"urgent":s.value.priority,assigned:s.value.assigned};s.value.assigned&&!["unassigned","me"].includes(s.value.assigned)&&(u.user_id=s.value.assigned,u.assigned="");const l=await F.get("/admin/support/tickets",{params:u});k.value=l.data.tickets||l.data.data||l.data,l.data.pagination?o.value=l.data.pagination:(l.data.meta||l.data.current_page)&&(o.value={current_page:((r=l.data.meta)==null?void 0:r.current_page)||l.data.current_page,last_page:((a=l.data.meta)==null?void 0:a.last_page)||l.data.last_page,per_page:((e=l.data.meta)==null?void 0:e.per_page)||l.data.per_page||15,total:((c=l.data.meta)==null?void 0:c.total)||l.data.total}),l.data.stats&&(f.value=l.data.stats)}catch(u){console.error("Failed to fetch tickets:",u)}finally{C.value=!1}},H=()=>{clearTimeout(j),j=setTimeout(()=>{o.value.current_page=1,m()},300)},O=(r,a)=>{a==="urgent"?(s.value.status="urgent",s.value.priority=""):s.value[r]=s.value[r]===a?"":a,o.value.current_page=1,m()},W=()=>{o.value.current_page=1,m()},q=async()=>{try{const r=await F.get("/admin/support/tickets/staff/users");T.value=r.data.users||[]}catch(r){console.error("Failed to fetch staff users:",r)}},E=()=>{s.value={search:"",status:"",priority:"",assigned:""},o.value.current_page=1,m()},V=r=>{r>=1&&r<=o.value.last_page&&(o.value.current_page=r,m())},G=r=>M.push(`/tickets/${r}`),J=r=>({open:"Open",waiting_response:"Waiting",answered:"Answered",closed:"Closed"})[r]||r,Z=r=>{if(!r)return"N/A";const a=new Date(r),c=new Date-a,u=Math.floor(c/6e4),l=Math.floor(c/36e5),x=Math.floor(c/864e5);return u<60?`${u}m ago`:l<24?`${l}h ago`:x<7?`${x}d ago`:a.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return(r,a)=>(n(),i("div",xe,[t("div",he,[(n(!0),i(_,null,w(P.value,e=>(n(),i("button",{key:e.key,onClick:c=>O("status",e.filterValue),class:v(["relative overflow-hidden rounded-2xl p-5 text-left transition-all group",s.value.status===e.filterValue?"bg-gradient-to-br ring-2 ring-offset-2 ring-offset-slate-900 "+e.activeRing+" "+e.activeBg:"bg-slate-800/50 hover:bg-slate-800 border border-slate-700/50 hover:border-slate-600/50"])},[t("div",we,[t("div",null,[t("p",{class:v(["text-3xl font-bold",s.value.status===e.filterValue?"text-white":e.textColor])},d(e.value),3),t("p",{class:v(["text-sm font-medium mt-1",s.value.status===e.filterValue?"text-white/80":"text-slate-400"])},d(e.label),3)]),t("div",{class:v(["p-3 rounded-xl",s.value.status===e.filterValue?"bg-white/20":e.iconBg])},[(n(),ne(ie(e.icon),{class:v(["w-6 h-6",s.value.status===e.filterValue?"text-white":e.iconColor])},null,8,["class"]))],2)])],10,_e))),128))]),t("div",ye,[t("div",ke,[g(p(X),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),$(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.value.search=e),type:"text",placeholder:"Search tickets by subject or ID...",onInput:H,class:"w-full pl-12 pr-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50 transition-all"},null,544),[[Y,s.value.search]])]),t("div",Ce,[$(t("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>s.value.priority=e),onChange:m,class:"px-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all"},[...a[5]||(a[5]=[ee('<option value="" data-v-71f28686>All Priorities</option><option value="urgent" data-v-71f28686>ðŸ”´ Urgent</option><option value="high" data-v-71f28686>ðŸŸ  High</option><option value="medium" data-v-71f28686>ðŸŸ¡ Medium</option><option value="low" data-v-71f28686>ðŸŸ¢ Low</option>',5)])],544),[[L,s.value.priority]]),$(t("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>s.value.assigned=e),onChange:W,class:"px-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all"},[a[6]||(a[6]=t("option",{value:""},"All Tickets",-1)),a[7]||(a[7]=t("option",{value:"unassigned"},"Unassigned",-1)),a[8]||(a[8]=t("option",{value:"me"},"Assigned to Me",-1)),a[9]||(a[9]=t("option",{disabled:""},"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€",-1)),(n(!0),i(_,null,w(T.value,e=>(n(),i("option",{key:e.id,value:e.id},d(e.username),9,Ve))),128))],544),[[L,s.value.assigned]]),U.value?(n(),i("button",{key:0,onClick:E,class:"inline-flex items-center gap-2 px-4 py-3 text-slate-400 hover:text-white transition-colors"},[g(p(te),{class:"w-4 h-4"}),a[10]||(a[10]=h(" Clear ",-1))])):y("",!0)])]),C.value?(n(),i("div",$e,[...a[11]||(a[11]=[t("div",{class:"flex flex-col items-center justify-center"},[t("div",{class:"w-12 h-12 border-4 border-amber-500/30 border-t-amber-500 rounded-full animate-spin mb-4"}),t("p",{class:"text-slate-400"},"Loading tickets...")],-1)])])):k.value.length===0?(n(),i("div",Be,[t("div",Me,[t("div",Te,[g(p(ae),{class:"w-8 h-8 text-slate-500"})]),a[12]||(a[12]=t("h3",{class:"text-lg font-semibold text-white mb-2"},"No tickets found",-1)),t("p",je,d(U.value?"Try adjusting your filters":"All support tickets will appear here"),1)])])):(n(),i("div",Ae,[g(re,{name:"list"},{default:se(()=>[(n(!0),i(_,null,w(k.value,e=>{var c,u,l,x,D,S;return n(),i("div",{key:e.id,onClick:at=>G(e.id),class:"group relative bg-slate-800/50 hover:bg-slate-800 backdrop-blur-sm rounded-2xl border border-slate-700/50 hover:border-slate-600/50 p-5 cursor-pointer transition-all"},[t("div",{class:v(["absolute left-0 top-0 bottom-0 w-1 rounded-l-2xl",((c=A[e.priority])==null?void 0:c.bar)||"bg-slate-600"])},null,2),t("div",De,[t("div",Se,[t("div",Fe,[t("span",Le,"#"+d(e.id),1),t("span",{class:v(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium",((u=I[e.status])==null?void 0:u.badge)||"bg-slate-700 text-slate-300"])},d(J(e.status)),3),t("span",{class:v(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium",((l=A[e.priority])==null?void 0:l.badge)||"bg-slate-700 text-slate-300"])},d(e.priority),3)]),t("h3",Ne,d(e.subject),1),t("div",Re,[t("span",Ie,[g(p(de),{class:"w-4 h-4"}),h(" "+d(((x=e.user)==null?void 0:x.username)||"Unknown"),1)]),t("span",Pe,[g(p(ue),{class:"w-4 h-4"}),h(" "+d(Z(e.updated_at)),1)]),e.messages_count?(n(),i("span",ze,[g(p(ce),{class:"w-4 h-4"}),h(" "+d(e.messages_count)+" messages ",1)])):y("",!0),e.category?(n(),i("span",He,[g(p(ve),{class:"w-4 h-4"}),h(" "+d(e.category.name),1)])):y("",!0)])]),t("div",Oe,[e.assigned_user?(n(),i("div",We,[t("div",qe,d((S=(D=e.assigned_user.username)==null?void 0:D.charAt(0))==null?void 0:S.toUpperCase()),1)])):(n(),i("div",Ee,[t("div",Ge,[g(p(ge),{class:"w-4 h-4"})])])),g(p(N),{class:"w-5 h-5 text-slate-600 group-hover:text-slate-400 transition-colors"})])])],8,Ue)}),128))]),_:1})])),o.value.last_page>1?(n(),i("div",Je,[t("p",Ze," Showing "+d((o.value.current_page-1)*o.value.per_page+1)+" to "+d(Math.min(o.value.current_page*o.value.per_page,o.value.total))+" of "+d(o.value.total)+" tickets ",1),t("div",Ke,[t("button",{onClick:a[3]||(a[3]=e=>V(o.value.current_page-1)),disabled:o.value.current_page===1,class:"p-2 rounded-lg bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[g(p(oe),{class:"w-5 h-5"})],8,Qe),t("div",Xe,[(n(!0),i(_,null,w(z.value,e=>(n(),i("button",{key:e,onClick:c=>V(e),class:v(["w-10 h-10 rounded-lg text-sm font-medium transition-colors",e===o.value.current_page?"bg-gradient-to-r from-amber-500 to-orange-600 text-white":"bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700"])},d(e),11,Ye))),128))]),t("button",{onClick:a[4]||(a[4]=e=>V(o.value.current_page+1)),disabled:o.value.current_page===o.value.last_page,class:"p-2 rounded-lg bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[g(p(N),{class:"w-5 h-5"})],8,et)])])):y("",!0)]))}},nt=K(tt,[["__scopeId","data-v-71f28686"]]);export{nt as default};
