import{o as n,h as i,a as t,_ as K,e as Q,x as L,F as _,i as w,b as g,z as p,H as X,k as B,v as Y,m as N,s as ee,D as te,d as h,l as y,at as se,t as d,w as ae,ai as re,A as oe,B as R,g as b,q as M,u as le,n as v,c as ne,U as ie,J as de,ak as ue,au as ce,V as ge}from"./index-DhDiA3Nh.js";import{r as pe}from"./TagIcon-CzN8myWM.js";import{r as ve}from"./ClockIcon-OKBvF__o.js";import{r as me}from"./CheckCircleIcon-CL7x1Bn8.js";function be(j,k){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 13.5h3.86a2.25 2.25 0 0 1 2.012 1.244l.256.512a2.25 2.25 0 0 0 2.013 1.244h3.218a2.25 2.25 0 0 0 2.013-1.244l.256-.512a2.25 2.25 0 0 1 2.013-1.244h3.859m-19.5.338V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18v-4.162c0-.224-.034-.447-.1-.661L19.24 5.338a2.25 2.25 0 0 0-2.15-1.588H6.911a2.25 2.25 0 0 0-2.15 1.588L2.35 13.177a2.25 2.25 0 0 0-.1.661Z"})])}function fe(j,k){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"})])}const xe={class:"space-y-6"},he={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},_e=["onClick"],we={class:"flex items-center justify-between"},ye={class:"flex flex-col lg:flex-row items-start lg:items-center gap-4"},ke={class:"relative flex-1 w-full lg:max-w-md"},Ce={class:"flex flex-wrap items-center gap-3"},Ve=["value"],$e={key:0,class:"rounded-2xl bg-slate-800/50 backdrop-blur border border-slate-700/50 p-12"},Be={key:1,class:"rounded-2xl bg-slate-800/50 backdrop-blur border border-slate-700/50 p-12"},Me={class:"flex flex-col items-center justify-center"},je={class:"w-16 h-16 rounded-2xl bg-slate-700/30 flex items-center justify-center mb-4"},Ae={class:"text-slate-400 text-center max-w-sm"},Te={key:2,class:"space-y-3"},Ue=["onClick"],De={class:"flex items-start gap-4 pl-3"},Se={class:"flex-1 min-w-0"},Fe={class:"flex items-center gap-3 mb-2"},Le={class:"text-xs font-mono text-slate-500"},Ne={class:"text-white font-medium group-hover:text-amber-400 transition-colors truncate mb-2"},Re={class:"flex flex-wrap items-center gap-4 text-sm text-slate-400"},He={class:"inline-flex items-center gap-1.5"},Ie={class:"inline-flex items-center gap-1.5"},Pe={key:0,class:"inline-flex items-center gap-1.5"},Ze={key:1,class:"inline-flex items-center gap-1.5"},ze={class:"flex items-center gap-3"},Oe={key:0,class:"flex items-center gap-2"},We={class:"w-9 h-9 rounded-full bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center text-white text-sm font-semibold"},qe={key:1,class:"flex items-center gap-2 text-slate-500"},Ee={class:"w-9 h-9 rounded-full bg-slate-700/50 border-2 border-dashed border-slate-600 flex items-center justify-center"},Ge={key:3,class:"flex items-center justify-between"},Je={class:"text-sm text-slate-400"},Ke={class:"flex items-center gap-2"},Qe=["disabled"],Xe={class:"flex items-center gap-1"},Ye=["onClick"],et=["disabled"],tt={__name:"TicketListView",setup(j){const k=le(),C=b([]),V=b(!1),f=b({open:0,waiting:0,urgent:0,closed:0}),a=b({search:"",status:"",priority:"",assigned:""}),o=b({current_page:1,last_page:1,per_page:15,total:0}),A=b([]);let T=null;const H={open:{badge:"bg-blue-500/20 text-blue-400"},waiting_response:{badge:"bg-amber-500/20 text-amber-400"},answered:{badge:"bg-emerald-500/20 text-emerald-400"},closed:{badge:"bg-slate-600/50 text-slate-400"}},U={urgent:{bar:"bg-red-500",badge:"bg-red-500/20 text-red-400"},high:{bar:"bg-orange-500",badge:"bg-orange-500/20 text-orange-400"},medium:{bar:"bg-amber-500",badge:"bg-amber-500/20 text-amber-400"},low:{bar:"bg-emerald-500",badge:"bg-emerald-500/20 text-emerald-400"}},I=M(()=>[{key:"open",label:"Open",value:f.value.open,filterValue:"open",icon:be,iconBg:"bg-blue-500/20",iconColor:"text-blue-400",textColor:"text-blue-400",activeBg:"from-blue-500 to-blue-600",activeRing:"ring-blue-500"},{key:"waiting",label:"Waiting",value:f.value.waiting,filterValue:"waiting_response",icon:ve,iconBg:"bg-amber-500/20",iconColor:"text-amber-400",textColor:"text-amber-400",activeBg:"from-amber-500 to-orange-600",activeRing:"ring-amber-500"},{key:"urgent",label:"Urgent",value:f.value.urgent,filterValue:"urgent",icon:ge,iconBg:"bg-red-500/20",iconColor:"text-red-400",textColor:"text-red-400",activeBg:"from-red-500 to-red-600",activeRing:"ring-red-500"},{key:"closed",label:"Closed",value:f.value.closed,filterValue:"closed",icon:me,iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",textColor:"text-emerald-400",activeBg:"from-emerald-500 to-emerald-600",activeRing:"ring-emerald-500"}]),D=M(()=>a.value.search||a.value.status||a.value.priority||a.value.assigned),P=M(()=>{const r=[],s=o.value.current_page,e=o.value.last_page,c=2;for(let u=Math.max(1,s-c);u<=Math.min(e,s+c);u++)r.push(u);return r});Q(()=>{m(),W()});const m=async()=>{var r,s,e,c;V.value=!0;try{const u={page:o.value.current_page,search:a.value.search,status:a.value.status==="urgent"?"":a.value.status,priority:a.value.status==="urgent"?"urgent":a.value.priority,assigned:a.value.assigned};a.value.assigned&&!["unassigned","me"].includes(a.value.assigned)&&(u.user_id=a.value.assigned,u.assigned="");const l=await L.get("/admin/support/tickets",{params:u});C.value=l.data.tickets||l.data.data||l.data,l.data.pagination?o.value=l.data.pagination:(l.data.meta||l.data.current_page)&&(o.value={current_page:((r=l.data.meta)==null?void 0:r.current_page)||l.data.current_page,last_page:((s=l.data.meta)==null?void 0:s.last_page)||l.data.last_page,per_page:((e=l.data.meta)==null?void 0:e.per_page)||l.data.per_page||15,total:((c=l.data.meta)==null?void 0:c.total)||l.data.total}),l.data.stats&&(f.value=l.data.stats)}catch(u){console.error("Failed to fetch tickets:",u)}finally{V.value=!1}},Z=()=>{clearTimeout(T),T=setTimeout(()=>{o.value.current_page=1,m()},300)},z=(r,s)=>{s==="urgent"?(a.value.status="urgent",a.value.priority=""):a.value[r]=a.value[r]===s?"":s,o.value.current_page=1,m()},O=()=>{o.value.current_page=1,m()},W=async()=>{try{const r=await L.get("/admin/support/tickets/staff/users");A.value=r.data.users||[]}catch(r){console.error("Failed to fetch staff users:",r)}},q=()=>{a.value={search:"",status:"",priority:"",assigned:""},o.value.current_page=1,m()},$=r=>{r>=1&&r<=o.value.last_page&&(o.value.current_page=r,m())},E=r=>k.push(`/tickets/${r}`),G=r=>({open:"Open",waiting_response:"Waiting",answered:"Answered",closed:"Closed"})[r]||r,J=r=>{if(!r)return"N/A";const s=new Date(r),c=new Date-s,u=Math.floor(c/6e4),l=Math.floor(c/36e5),x=Math.floor(c/864e5);return u<60?`${u}m ago`:l<24?`${l}h ago`:x<7?`${x}d ago`:s.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return(r,s)=>(n(),i("div",xe,[t("div",he,[(n(!0),i(_,null,w(I.value,e=>(n(),i("button",{key:e.key,onClick:c=>z("status",e.filterValue),class:v(["relative overflow-hidden rounded-2xl p-5 text-left transition-all group",a.value.status===e.filterValue?"bg-gradient-to-br ring-2 ring-offset-2 ring-offset-slate-900 "+e.activeRing+" "+e.activeBg:"bg-slate-800/50 hover:bg-slate-800 border border-slate-700/50 hover:border-slate-600/50"])},[t("div",we,[t("div",null,[t("p",{class:v(["text-3xl font-bold",a.value.status===e.filterValue?"text-white":e.textColor])},d(e.value),3),t("p",{class:v(["text-sm font-medium mt-1",a.value.status===e.filterValue?"text-white/80":"text-slate-400"])},d(e.label),3)]),t("div",{class:v(["p-3 rounded-xl",a.value.status===e.filterValue?"bg-white/20":e.iconBg])},[(n(),ne(ie(e.icon),{class:v(["w-6 h-6",a.value.status===e.filterValue?"text-white":e.iconColor])},null,8,["class"]))],2)])],10,_e))),128))]),t("div",ye,[t("div",ke,[g(p(X),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),B(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>a.value.search=e),type:"text",placeholder:"Search tickets by subject or ID...",onInput:Z,class:"w-full pl-12 pr-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50 transition-all"},null,544),[[Y,a.value.search]])]),t("div",Ce,[B(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>a.value.priority=e),onChange:m,class:"px-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all"},[...s[5]||(s[5]=[ee('<option value="" data-v-71f28686>All Priorities</option><option value="urgent" data-v-71f28686>ðŸ”´ Urgent</option><option value="high" data-v-71f28686>ðŸŸ  High</option><option value="medium" data-v-71f28686>ðŸŸ¡ Medium</option><option value="low" data-v-71f28686>ðŸŸ¢ Low</option>',5)])],544),[[N,a.value.priority]]),B(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>a.value.assigned=e),onChange:O,class:"px-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all"},[s[6]||(s[6]=t("option",{value:""},"All Tickets",-1)),s[7]||(s[7]=t("option",{value:"unassigned"},"Unassigned",-1)),s[8]||(s[8]=t("option",{value:"me"},"Assigned to Me",-1)),s[9]||(s[9]=t("option",{disabled:""},"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€",-1)),(n(!0),i(_,null,w(A.value,e=>(n(),i("option",{key:e.id,value:e.id},d(e.username),9,Ve))),128))],544),[[N,a.value.assigned]]),D.value?(n(),i("button",{key:0,onClick:q,class:"inline-flex items-center gap-2 px-4 py-3 text-slate-400 hover:text-white transition-colors"},[g(p(te),{class:"w-4 h-4"}),s[10]||(s[10]=h(" Clear ",-1))])):y("",!0)])]),V.value?(n(),i("div",$e,[...s[11]||(s[11]=[t("div",{class:"flex flex-col items-center justify-center"},[t("div",{class:"w-12 h-12 border-4 border-amber-500/30 border-t-amber-500 rounded-full animate-spin mb-4"}),t("p",{class:"text-slate-400"},"Loading tickets...")],-1)])])):C.value.length===0?(n(),i("div",Be,[t("div",Me,[t("div",je,[g(p(se),{class:"w-8 h-8 text-slate-500"})]),s[12]||(s[12]=t("h3",{class:"text-lg font-semibold text-white mb-2"},"No tickets found",-1)),t("p",Ae,d(D.value?"Try adjusting your filters":"All support tickets will appear here"),1)])])):(n(),i("div",Te,[g(re,{name:"list"},{default:ae(()=>[(n(!0),i(_,null,w(C.value,e=>{var c,u,l,x,S,F;return n(),i("div",{key:e.id,onClick:st=>E(e.id),class:"group relative bg-slate-800/50 hover:bg-slate-800 backdrop-blur-sm rounded-2xl border border-slate-700/50 hover:border-slate-600/50 p-5 cursor-pointer transition-all"},[t("div",{class:v(["absolute left-0 top-0 bottom-0 w-1 rounded-l-2xl",((c=U[e.priority])==null?void 0:c.bar)||"bg-slate-600"])},null,2),t("div",De,[t("div",Se,[t("div",Fe,[t("span",Le,"#"+d(e.id),1),t("span",{class:v(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium",((u=H[e.status])==null?void 0:u.badge)||"bg-slate-700 text-slate-300"])},d(G(e.status)),3),t("span",{class:v(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium",((l=U[e.priority])==null?void 0:l.badge)||"bg-slate-700 text-slate-300"])},d(e.priority),3)]),t("h3",Ne,d(e.subject),1),t("div",Re,[t("span",He,[g(p(de),{class:"w-4 h-4"}),h(" "+d(((x=e.user)==null?void 0:x.username)||"Unknown"),1)]),t("span",Ie,[g(p(ue),{class:"w-4 h-4"}),h(" "+d(J(e.updated_at)),1)]),e.messages_count?(n(),i("span",Pe,[g(p(ce),{class:"w-4 h-4"}),h(" "+d(e.messages_count)+" messages ",1)])):y("",!0),e.category?(n(),i("span",Ze,[g(p(pe),{class:"w-4 h-4"}),h(" "+d(e.category.name),1)])):y("",!0)])]),t("div",ze,[e.assigned_user?(n(),i("div",Oe,[t("div",We,d((F=(S=e.assigned_user.username)==null?void 0:S.charAt(0))==null?void 0:F.toUpperCase()),1)])):(n(),i("div",qe,[t("div",Ee,[g(p(fe),{class:"w-4 h-4"})])])),g(p(R),{class:"w-5 h-5 text-slate-600 group-hover:text-slate-400 transition-colors"})])])],8,Ue)}),128))]),_:1})])),o.value.last_page>1?(n(),i("div",Ge,[t("p",Je," Showing "+d((o.value.current_page-1)*o.value.per_page+1)+" to "+d(Math.min(o.value.current_page*o.value.per_page,o.value.total))+" of "+d(o.value.total)+" tickets ",1),t("div",Ke,[t("button",{onClick:s[3]||(s[3]=e=>$(o.value.current_page-1)),disabled:o.value.current_page===1,class:"p-2 rounded-lg bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[g(p(oe),{class:"w-5 h-5"})],8,Qe),t("div",Xe,[(n(!0),i(_,null,w(P.value,e=>(n(),i("button",{key:e,onClick:c=>$(e),class:v(["w-10 h-10 rounded-lg text-sm font-medium transition-colors",e===o.value.current_page?"bg-gradient-to-r from-amber-500 to-orange-600 text-white":"bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700"])},d(e),11,Ye))),128))]),t("button",{onClick:s[4]||(s[4]=e=>$(o.value.current_page+1)),disabled:o.value.current_page===o.value.last_page,class:"p-2 rounded-lg bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[g(p(R),{class:"w-5 h-5"})],8,et)])])):y("",!0)]))}},nt=K(tt,[["__scopeId","data-v-71f28686"]]);export{nt as default};
