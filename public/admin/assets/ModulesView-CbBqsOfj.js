import{_ as j,e as q,h as n,a as s,d as M,p as U,l as p,F as C,i as h,j as w,t as i,s as f,g as c,q as D,A as K,o as a}from"./index-De1YOoqH.js";const R={class:"modules-page"},W={class:"modules-header"},G={class:"header-actions"},H={class:"tabs"},J={key:0,class:"loading"},O={key:1,class:"modules-grid"},Q={key:0,class:"no-modules"},X={class:"module-header"},Y={class:"module-icon"},ee={class:"module-info"},se={class:"version"},le={class:"module-status"},oe={class:"module-description"},ne={key:0,class:"dependencies"},ae={class:"module-actions"},te=["onClick"],ie=["onClick"],de=["onClick"],ue={key:2,class:"modules-grid"},re={key:0,class:"no-modules"},ce={class:"module-header"},ve={class:"module-icon"},pe={class:"module-info"},me={class:"version"},be={class:"module-description"},fe={key:0,class:"dependencies"},ye={class:"module-actions"},ge=["onClick"],ke={class:"modal-header"},Me={class:"modal-body"},_e={key:0,class:"file-info"},Ce={class:"file-size"},he={class:"modal-footer"},we=["disabled"],Fe={class:"modal-header"},$e={class:"modal-body"},Ue={class:"modal-footer"},ze={__name:"ModulesView",setup(Ie){const{showToast:d}=K(),F=c([]),$=c(!0),y=c("installed"),m=c(!1),b=c(!1),u=c(null),_=c(!1),g=c(null),T=c(null),z=D(()=>F.value.filter(o=>o.installed)),I=D(()=>F.value.filter(o=>!o.installed)),B=o=>({module:"ðŸŽ®",theme:"ðŸŽ¨",plugin:"ðŸ”Œ"})[o]||"ðŸ“¦",v=async()=>{$.value=!0;try{const o=await f.get("/admin/modules");F.value=o.data.modules||[]}catch(o){console.error("Failed to load modules:",o),d("Failed to load modules","error")}finally{$.value=!1}},N=async o=>{var e,t;try{await f.put(`/admin/modules/${o}/enable`),d("Module enabled","success"),await v()}catch(l){console.error("Failed to enable module:",l),d(((t=(e=l.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to enable module","error")}},P=async o=>{try{await f.put(`/admin/modules/${o}/disable`),d("Module disabled","success"),await v()}catch(e){console.error("Failed to disable module:",e),d("Failed to disable module","error")}},V=async o=>{var e,t;try{await f.post(`/admin/modules/${o}/install`),d("Module installed successfully","success"),await v()}catch(l){console.error("Failed to install module:",l),d(((t=(e=l.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to install module","error")}},x=o=>{g.value=o,b.value=!0},Z=async()=>{var o,e;if(g.value)try{await f.delete(`/admin/modules/${g.value.slug}`),d("Module uninstalled successfully","success"),b.value=!1,g.value=null,await v()}catch(t){console.error("Failed to uninstall module:",t),d(((e=(o=t.response)==null?void 0:o.data)==null?void 0:e.message)||"Failed to uninstall module","error")}},A=o=>{const e=o.target.files[0];if(e){if(e.size>10*1024*1024){d("File size must be less than 10MB","error");return}u.value=e}},E=o=>{const e=o.dataTransfer.files[0];if(e&&e.name.endsWith(".zip")){if(e.size>10*1024*1024){d("File size must be less than 10MB","error");return}u.value=e}else d("Please upload a ZIP file","error")},S=async()=>{var e,t;if(!u.value)return;_.value=!0;const o=new FormData;o.append("file",u.value),o.append("type","module");try{await f.post("/admin/modules/upload",o,{headers:{"Content-Type":"multipart/form-data"}}),d("Module uploaded successfully","success"),m.value=!1,u.value=null,await v()}catch(l){console.error("Failed to upload module:",l),d(((t=(e=l.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to upload module","error")}finally{_.value=!1}},L=o=>{if(o===0)return"0 Bytes";const e=1024,t=["Bytes","KB","MB"],l=Math.floor(Math.log(o)/Math.log(e));return Math.round(o/Math.pow(e,l)*100)/100+" "+t[l]};return q(()=>{v()}),(o,e)=>{var t;return a(),n("div",R,[s("div",W,[e[15]||(e[15]=s("h1",null,"ðŸ“¦ Module Manager",-1)),s("div",G,[s("button",{class:"btn-secondary",onClick:e[0]||(e[0]=l=>m.value=!0)},[...e[13]||(e[13]=[s("span",null,"â¬†ï¸",-1),M(" Upload Module ",-1)])]),s("button",{class:"btn-primary",onClick:v},[...e[14]||(e[14]=[s("span",null,"ðŸ”„",-1),M(" Refresh ",-1)])])])]),s("div",H,[s("button",{class:U({active:y.value==="installed"}),onClick:e[1]||(e[1]=l=>y.value="installed")}," Installed Modules ",2),s("button",{class:U({active:y.value==="available"}),onClick:e[2]||(e[2]=l=>y.value="available")}," Available Modules ",2)]),$.value?(a(),n("div",J,[...e[16]||(e[16]=[s("div",{class:"spinner"},null,-1),M(" Loading modules... ",-1)])])):y.value==="installed"?(a(),n("div",O,[z.value.length===0?(a(),n("div",Q,[...e[17]||(e[17]=[s("p",null,"No modules installed.",-1),s("p",{class:"hint"},"Upload a module ZIP file to get started.",-1)])])):p("",!0),(a(!0),n(C,null,h(z.value,l=>{var k;return a(),n("div",{key:l.slug,class:"module-card installed"},[s("div",X,[s("div",Y,i(B(l.type)),1),s("div",ee,[s("h3",null,i(l.name),1),s("span",se,"v"+i(l.version),1)]),s("div",le,[s("span",{class:U(["badge",l.enabled?"badge-success":"badge-disabled"])},i(l.enabled?"Enabled":"Disabled"),3)])]),s("p",oe,i(l.description||"No description available"),1),(k=l.dependencies)!=null&&k.length?(a(),n("div",ne,[e[18]||(e[18]=s("strong",null,"Dependencies:",-1)),(a(!0),n(C,null,h(l.dependencies,r=>(a(),n("span",{key:r,class:"dep-tag"},i(r),1))),128))])):p("",!0),s("div",ae,[l.enabled?(a(),n("button",{key:0,class:"btn-action btn-warning",onClick:r=>P(l.slug)}," Disable ",8,te)):(a(),n("button",{key:1,class:"btn-action btn-success",onClick:r=>N(l.slug)}," Enable ",8,ie)),s("button",{class:"btn-action btn-danger",onClick:r=>x(l)}," Uninstall ",8,de)])])}),128))])):(a(),n("div",ue,[I.value.length===0?(a(),n("div",re,[...e[19]||(e[19]=[s("p",null,"No modules available for installation.",-1),s("p",{class:"hint"},"Upload module ZIP files to install them.",-1)])])):p("",!0),(a(!0),n(C,null,h(I.value,l=>{var k;return a(),n("div",{key:l.slug,class:"module-card available"},[s("div",ce,[s("div",ve,i(B(l.type)),1),s("div",pe,[s("h3",null,i(l.name),1),s("span",me,"v"+i(l.version),1)])]),s("p",be,i(l.description||"No description available"),1),(k=l.dependencies)!=null&&k.length?(a(),n("div",fe,[e[20]||(e[20]=s("strong",null,"Dependencies:",-1)),(a(!0),n(C,null,h(l.dependencies,r=>(a(),n("span",{key:r,class:"dep-tag"},i(r),1))),128))])):p("",!0),s("div",ye,[s("button",{class:"btn-action btn-primary",onClick:r=>V(l.slug)}," Install ",8,ge)])])}),128))])),m.value?(a(),n("div",{key:3,class:"modal-overlay",onClick:e[8]||(e[8]=l=>m.value=!1)},[s("div",{class:"modal",onClick:e[7]||(e[7]=w(()=>{},["stop"]))},[s("div",ke,[e[21]||(e[21]=s("h2",null,"Upload Module",-1)),s("button",{class:"btn-close",onClick:e[3]||(e[3]=l=>m.value=!1)},"Ã—")]),s("div",Me,[s("div",{class:"upload-area",onDragover:e[5]||(e[5]=w(()=>{},["prevent"])),onDrop:w(E,["prevent"])},[s("input",{ref_key:"fileInput",ref:T,type:"file",accept:".zip",onChange:A,style:{display:"none"}},null,544),s("div",{class:"upload-prompt",onClick:e[4]||(e[4]=l=>o.$refs.fileInput.click())},[...e[22]||(e[22]=[s("span",{class:"upload-icon"},"ðŸ“¦",-1),s("p",null,"Click to select or drag & drop module ZIP file",-1),s("p",{class:"hint"},"Maximum file size: 10MB",-1)])])],32),u.value?(a(),n("div",_e,[s("span",null,"ðŸ“„ "+i(u.value.name),1),s("span",Ce,i(L(u.value.size)),1)])):p("",!0)]),s("div",he,[s("button",{class:"btn-cancel",onClick:e[6]||(e[6]=l=>m.value=!1)},"Cancel"),s("button",{class:"btn-submit",disabled:!u.value||_.value,onClick:S},i(_.value?"Uploading...":"Upload"),9,we)])])])):p("",!0),b.value?(a(),n("div",{key:4,class:"modal-overlay",onClick:e[12]||(e[12]=l=>b.value=!1)},[s("div",{class:"modal modal-confirm",onClick:e[11]||(e[11]=w(()=>{},["stop"]))},[s("div",Fe,[e[23]||(e[23]=s("h2",null,"Confirm Uninstall",-1)),s("button",{class:"btn-close",onClick:e[9]||(e[9]=l=>b.value=!1)},"Ã—")]),s("div",$e,[s("p",null,[e[24]||(e[24]=M("Are you sure you want to uninstall ",-1)),s("strong",null,i((t=g.value)==null?void 0:t.name),1),e[25]||(e[25]=M("?",-1))]),e[26]||(e[26]=s("p",{class:"warning"},"This will remove all module files and database entries. This action cannot be undone.",-1))]),s("div",Ue,[s("button",{class:"btn-cancel",onClick:e[10]||(e[10]=l=>b.value=!1)},"Cancel"),s("button",{class:"btn-danger",onClick:Z},"Uninstall")])])])):p("",!0)])}}},De=j(ze,[["__scopeId","data-v-96d9aaa1"]]);export{De as default};
