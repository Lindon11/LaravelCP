import{o as l,h as i,a as t,_ as G,e as J,x as D,F as V,i as $,b as g,A as p,B as K,k as B,v as Q,m as N,s as X,H as Y,d as x,l as _,a6 as ee,t as d,w as te,M as ae,a7 as se,a8 as F,g as h,q as M,u as re,n as v,c as oe,N as le,a9 as ne,S as ie,aa as de,ab as ce,U as ue,C as ge}from"./index-CN3jF4kM.js";import{r as pe}from"./CheckCircleIcon-B_Q8nYyf.js";function ve(j,w){return l(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 13.5h3.86a2.25 2.25 0 0 1 2.012 1.244l.256.512a2.25 2.25 0 0 0 2.013 1.244h3.218a2.25 2.25 0 0 0 2.013-1.244l.256-.512a2.25 2.25 0 0 1 2.013-1.244h3.859m-19.5.338V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18v-4.162c0-.224-.034-.447-.1-.661L19.24 5.338a2.25 2.25 0 0 0-2.15-1.588H6.911a2.25 2.25 0 0 0-2.15 1.588L2.35 13.177a2.25 2.25 0 0 0-.1.661Z"})])}function be(j,w){return l(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.568 3H5.25A2.25 2.25 0 0 0 3 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 0 0 5.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 0 0 9.568 3Z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 6h.008v.008H6V6Z"})])}const me={class:"space-y-6"},fe={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},xe=["onClick"],he={class:"flex items-center justify-between"},_e={class:"flex flex-col lg:flex-row items-start lg:items-center gap-4"},we={class:"relative flex-1 w-full lg:max-w-md"},ye={class:"flex flex-wrap items-center gap-3"},ke={key:0,class:"rounded-2xl bg-slate-800/50 backdrop-blur border border-slate-700/50 p-12"},Ce={key:1,class:"rounded-2xl bg-slate-800/50 backdrop-blur border border-slate-700/50 p-12"},Ve={class:"flex flex-col items-center justify-center"},$e={class:"w-16 h-16 rounded-2xl bg-slate-700/30 flex items-center justify-center mb-4"},Be={class:"text-slate-400 text-center max-w-sm"},Me={key:2,class:"space-y-3"},je=["onClick"],Ae={class:"flex items-start gap-4 pl-3"},Te={class:"flex-1 min-w-0"},Se={class:"flex items-center gap-3 mb-2"},Ue={class:"text-xs font-mono text-slate-500"},Le={class:"text-white font-medium group-hover:text-amber-400 transition-colors truncate mb-2"},De={class:"flex flex-wrap items-center gap-4 text-sm text-slate-400"},Ne={class:"inline-flex items-center gap-1.5"},Fe={class:"inline-flex items-center gap-1.5"},Re={key:0,class:"inline-flex items-center gap-1.5"},He={key:1,class:"inline-flex items-center gap-1.5"},Ie={class:"flex items-center gap-3"},Pe={key:0,class:"flex items-center gap-2"},Ze={class:"w-9 h-9 rounded-full bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center text-white text-sm font-semibold"},Oe={key:1,class:"flex items-center gap-2 text-slate-500"},We={class:"w-9 h-9 rounded-full bg-slate-700/50 border-2 border-dashed border-slate-600 flex items-center justify-center"},qe={key:3,class:"flex items-center justify-between"},ze={class:"text-sm text-slate-400"},Ee={class:"flex items-center gap-2"},Ge=["disabled"],Je={class:"flex items-center gap-1"},Ke=["onClick"],Qe=["disabled"],Xe={__name:"TicketListView",setup(j){const w=re(),y=h([]),k=h(!1),m=h({open:0,waiting:0,urgent:0,closed:0}),s=h({search:"",status:"",priority:"",assigned:""}),o=h({current_page:1,last_page:1,per_page:15,total:0});let A=null;const R={open:{badge:"bg-blue-500/20 text-blue-400"},waiting_response:{badge:"bg-amber-500/20 text-amber-400"},answered:{badge:"bg-emerald-500/20 text-emerald-400"},closed:{badge:"bg-slate-600/50 text-slate-400"}},T={urgent:{bar:"bg-red-500",badge:"bg-red-500/20 text-red-400"},high:{bar:"bg-orange-500",badge:"bg-orange-500/20 text-orange-400"},medium:{bar:"bg-amber-500",badge:"bg-amber-500/20 text-amber-400"},low:{bar:"bg-emerald-500",badge:"bg-emerald-500/20 text-emerald-400"}},H=M(()=>[{key:"open",label:"Open",value:m.value.open,filterValue:"open",icon:ve,iconBg:"bg-blue-500/20",iconColor:"text-blue-400",textColor:"text-blue-400",activeBg:"from-blue-500 to-blue-600",activeRing:"ring-blue-500"},{key:"waiting",label:"Waiting",value:m.value.waiting,filterValue:"waiting_response",icon:ue,iconBg:"bg-amber-500/20",iconColor:"text-amber-400",textColor:"text-amber-400",activeBg:"from-amber-500 to-orange-600",activeRing:"ring-amber-500"},{key:"urgent",label:"Urgent",value:m.value.urgent,filterValue:"urgent",icon:ge,iconBg:"bg-red-500/20",iconColor:"text-red-400",textColor:"text-red-400",activeBg:"from-red-500 to-red-600",activeRing:"ring-red-500"},{key:"closed",label:"Closed",value:m.value.closed,filterValue:"closed",icon:pe,iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",textColor:"text-emerald-400",activeBg:"from-emerald-500 to-emerald-600",activeRing:"ring-emerald-500"}]),S=M(()=>s.value.search||s.value.status||s.value.priority||s.value.assigned),I=M(()=>{const r=[],a=o.value.current_page,e=o.value.last_page,c=2;for(let u=Math.max(1,a-c);u<=Math.min(e,a+c);u++)r.push(u);return r});J(()=>{b(),P()});const b=async()=>{var r,a,e,c;k.value=!0;try{const u={page:o.value.current_page,search:s.value.search,status:s.value.status==="urgent"?"":s.value.status,priority:s.value.status==="urgent"?"urgent":s.value.priority,assigned:s.value.assigned},n=await D.get("/admin/tickets",{params:u});y.value=n.data.data||n.data,(n.data.meta||n.data.current_page)&&(o.value={current_page:((r=n.data.meta)==null?void 0:r.current_page)||n.data.current_page,last_page:((a=n.data.meta)==null?void 0:a.last_page)||n.data.last_page,per_page:((e=n.data.meta)==null?void 0:e.per_page)||n.data.per_page||15,total:((c=n.data.meta)==null?void 0:c.total)||n.data.total})}catch(u){console.error("Failed to fetch tickets:",u)}finally{k.value=!1}},P=async()=>{try{const r=await D.get("/admin/tickets/stats");m.value=r.data}catch(r){console.error("Failed to fetch stats:",r)}},Z=()=>{clearTimeout(A),A=setTimeout(()=>{o.value.current_page=1,b()},300)},O=(r,a)=>{a==="urgent"?(s.value.status="urgent",s.value.priority=""):s.value[r]=s.value[r]===a?"":a,o.value.current_page=1,b()},W=()=>{s.value={search:"",status:"",priority:"",assigned:""},o.value.current_page=1,b()},C=r=>{r>=1&&r<=o.value.last_page&&(o.value.current_page=r,b())},q=r=>w.push(`/tickets/${r}`),z=r=>({open:"Open",waiting_response:"Waiting",answered:"Answered",closed:"Closed"})[r]||r,E=r=>{if(!r)return"N/A";const a=new Date(r),c=new Date-a,u=Math.floor(c/6e4),n=Math.floor(c/36e5),f=Math.floor(c/864e5);return u<60?`${u}m ago`:n<24?`${n}h ago`:f<7?`${f}d ago`:a.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return(r,a)=>(l(),i("div",me,[t("div",fe,[(l(!0),i(V,null,$(H.value,e=>(l(),i("button",{key:e.key,onClick:c=>O("status",e.filterValue),class:v(["relative overflow-hidden rounded-2xl p-5 text-left transition-all group",s.value.status===e.filterValue?"bg-gradient-to-br ring-2 ring-offset-2 ring-offset-slate-900 "+e.activeRing+" "+e.activeBg:"bg-slate-800/50 hover:bg-slate-800 border border-slate-700/50 hover:border-slate-600/50"])},[t("div",he,[t("div",null,[t("p",{class:v(["text-3xl font-bold",s.value.status===e.filterValue?"text-white":e.textColor])},d(e.value),3),t("p",{class:v(["text-sm font-medium mt-1",s.value.status===e.filterValue?"text-white/80":"text-slate-400"])},d(e.label),3)]),t("div",{class:v(["p-3 rounded-xl",s.value.status===e.filterValue?"bg-white/20":e.iconBg])},[(l(),oe(le(e.icon),{class:v(["w-6 h-6",s.value.status===e.filterValue?"text-white":e.iconColor])},null,8,["class"]))],2)])],10,xe))),128))]),t("div",_e,[t("div",we,[g(p(K),{class:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),B(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.value.search=e),type:"text",placeholder:"Search tickets by subject or ID...",onInput:Z,class:"w-full pl-12 pr-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50 transition-all"},null,544),[[Q,s.value.search]])]),t("div",ye,[B(t("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>s.value.priority=e),onChange:b,class:"px-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all"},[...a[5]||(a[5]=[X('<option value="" data-v-1ecfafd6>All Priorities</option><option value="urgent" data-v-1ecfafd6>ðŸ”´ Urgent</option><option value="high" data-v-1ecfafd6>ðŸŸ  High</option><option value="medium" data-v-1ecfafd6>ðŸŸ¡ Medium</option><option value="low" data-v-1ecfafd6>ðŸŸ¢ Low</option>',5)])],544),[[N,s.value.priority]]),B(t("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>s.value.assigned=e),onChange:b,class:"px-4 py-3 bg-slate-800/50 border border-slate-700/50 rounded-xl text-slate-300 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all"},[...a[6]||(a[6]=[t("option",{value:""},"All Tickets",-1),t("option",{value:"unassigned"},"Unassigned",-1),t("option",{value:"me"},"Assigned to Me",-1)])],544),[[N,s.value.assigned]]),S.value?(l(),i("button",{key:0,onClick:W,class:"inline-flex items-center gap-2 px-4 py-3 text-slate-400 hover:text-white transition-colors"},[g(p(Y),{class:"w-4 h-4"}),a[7]||(a[7]=x(" Clear ",-1))])):_("",!0)])]),k.value?(l(),i("div",ke,[...a[8]||(a[8]=[t("div",{class:"flex flex-col items-center justify-center"},[t("div",{class:"w-12 h-12 border-4 border-amber-500/30 border-t-amber-500 rounded-full animate-spin mb-4"}),t("p",{class:"text-slate-400"},"Loading tickets...")],-1)])])):y.value.length===0?(l(),i("div",Ce,[t("div",Ve,[t("div",$e,[g(p(ee),{class:"w-8 h-8 text-slate-500"})]),a[9]||(a[9]=t("h3",{class:"text-lg font-semibold text-white mb-2"},"No tickets found",-1)),t("p",Be,d(S.value?"Try adjusting your filters":"All support tickets will appear here"),1)])])):(l(),i("div",Me,[g(ae,{name:"list"},{default:te(()=>[(l(!0),i(V,null,$(y.value,e=>{var c,u,n,f,U,L;return l(),i("div",{key:e.id,onClick:Ye=>q(e.id),class:"group relative bg-slate-800/50 hover:bg-slate-800 backdrop-blur-sm rounded-2xl border border-slate-700/50 hover:border-slate-600/50 p-5 cursor-pointer transition-all"},[t("div",{class:v(["absolute left-0 top-0 bottom-0 w-1 rounded-l-2xl",((c=T[e.priority])==null?void 0:c.bar)||"bg-slate-600"])},null,2),t("div",Ae,[t("div",Te,[t("div",Se,[t("span",Ue,"#"+d(e.id),1),t("span",{class:v(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium",((u=R[e.status])==null?void 0:u.badge)||"bg-slate-700 text-slate-300"])},d(z(e.status)),3),t("span",{class:v(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium",((n=T[e.priority])==null?void 0:n.badge)||"bg-slate-700 text-slate-300"])},d(e.priority),3)]),t("h3",Le,d(e.subject),1),t("div",De,[t("span",Ne,[g(p(ne),{class:"w-4 h-4"}),x(" "+d(((f=e.user)==null?void 0:f.username)||"Unknown"),1)]),t("span",Fe,[g(p(ie),{class:"w-4 h-4"}),x(" "+d(E(e.updated_at)),1)]),e.messages_count?(l(),i("span",Re,[g(p(de),{class:"w-4 h-4"}),x(" "+d(e.messages_count)+" messages ",1)])):_("",!0),e.category?(l(),i("span",He,[g(p(be),{class:"w-4 h-4"}),x(" "+d(e.category.name),1)])):_("",!0)])]),t("div",Ie,[e.assigned_user?(l(),i("div",Pe,[t("div",Ze,d((L=(U=e.assigned_user.username)==null?void 0:U.charAt(0))==null?void 0:L.toUpperCase()),1)])):(l(),i("div",Oe,[t("div",We,[g(p(ce),{class:"w-4 h-4"})])])),g(p(F),{class:"w-5 h-5 text-slate-600 group-hover:text-slate-400 transition-colors"})])])],8,je)}),128))]),_:1})])),o.value.last_page>1?(l(),i("div",qe,[t("p",ze," Showing "+d((o.value.current_page-1)*o.value.per_page+1)+" to "+d(Math.min(o.value.current_page*o.value.per_page,o.value.total))+" of "+d(o.value.total)+" tickets ",1),t("div",Ee,[t("button",{onClick:a[3]||(a[3]=e=>C(o.value.current_page-1)),disabled:o.value.current_page===1,class:"p-2 rounded-lg bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[g(p(se),{class:"w-5 h-5"})],8,Ge),t("div",Je,[(l(!0),i(V,null,$(I.value,e=>(l(),i("button",{key:e,onClick:c=>C(e),class:v(["w-10 h-10 rounded-lg text-sm font-medium transition-colors",e===o.value.current_page?"bg-gradient-to-r from-amber-500 to-orange-600 text-white":"bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700"])},d(e),11,Ke))),128))]),t("button",{onClick:a[4]||(a[4]=e=>C(o.value.current_page+1)),disabled:o.value.current_page===o.value.last_page,class:"p-2 rounded-lg bg-slate-800 text-slate-400 hover:text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[g(p(F),{class:"w-5 h-5"})],8,Qe)])])):_("",!0)]))}},at=G(Xe,[["__scopeId","data-v-1ecfafd6"]]);export{at as default};
