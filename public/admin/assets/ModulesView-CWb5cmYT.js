import{_ as q,e as K,h as o,a as s,d as _,p as z,l as p,F as C,i as w,j as F,t as i,s as b,g as c,q as T,A as R,o as t}from"./index-CRC9Il98.js";const W={class:"modules-page"},G={class:"modules-header"},H={class:"header-actions"},J={class:"tabs"},O={key:0,class:"loading"},Q={key:1,class:"modules-grid"},X={key:0,class:"no-modules"},Y={class:"module-header"},ee={class:"module-icon"},se={class:"module-info"},le={class:"version"},ne={class:"module-status"},oe={class:"module-description"},te={key:0,class:"dependencies"},ae={class:"module-actions"},ie=["onClick"],de=["onClick"],ue=["onClick"],re={key:2,class:"modules-grid"},ce={key:0,class:"no-modules"},ve={class:"module-header"},pe={class:"module-icon"},me={class:"module-info"},fe={class:"version"},be={class:"module-description"},ye={key:0,class:"dependencies"},ge={class:"module-actions"},ke=["onClick"],Me={class:"modal-header"},_e={class:"modal-body"},he={key:0,class:"file-info"},Ce={class:"file-size"},we={class:"modal-footer"},Fe=["disabled"],$e={class:"modal-header"},Ue={class:"modal-body"},ze={class:"modal-footer"},Ie={__name:"ModulesView",setup(Be){const{success:y,error:d}=R(),$=c([]),U=c(!0),g=c("installed"),m=c(!1),f=c(!1),u=c(null),h=c(!1),k=c(null),N=c(null),I=T(()=>$.value.filter(n=>n.installed)),B=T(()=>$.value.filter(n=>!n.installed)),D=n=>({module:"ðŸŽ®",theme:"ðŸŽ¨",plugin:"ðŸ”Œ"})[n]||"ðŸ“¦",v=async()=>{U.value=!0;try{const n=await b.get("/admin/modules");$.value=n.data.modules||[]}catch(n){console.error("Failed to load modules:",n),d("Failed to load modules")}finally{U.value=!1}},P=async n=>{var e,a;try{await b.put(`/admin/modules/${n}/enable`),y("Module enabled"),await v()}catch(l){console.error("Failed to enable module:",l),d(((a=(e=l.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to enable module")}},V=async n=>{try{await b.put(`/admin/modules/${n}/disable`),y("Module disabled"),await v()}catch(e){console.error("Failed to disable module:",e),d("Failed to disable module")}},x=async n=>{var e,a;try{await b.post(`/admin/modules/${n}/install`),y("Module installed successfully"),await v()}catch(l){console.error("Failed to install module:",l),d(((a=(e=l.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to install module")}},E=n=>{k.value=n,f.value=!0},S=async()=>{var n,e;if(k.value)try{await b.delete(`/admin/modules/${k.value.slug}`),y("Module uninstalled successfully"),f.value=!1,k.value=null,await v()}catch(a){console.error("Failed to uninstall module:",a),d(((e=(n=a.response)==null?void 0:n.data)==null?void 0:e.message)||"Failed to uninstall module")}},Z=n=>{const e=n.target.files[0];if(e){if(e.size>10*1024*1024){d("File size must be less than 10MB");return}u.value=e}},A=n=>{const e=n.dataTransfer.files[0];if(e&&e.name.endsWith(".zip")){if(e.size>10*1024*1024){d("File size must be less than 10MB");return}u.value=e}else d("Please upload a ZIP file")},L=async()=>{var e,a;if(!u.value)return;h.value=!0;const n=new FormData;n.append("file",u.value),n.append("type","module");try{await b.post("/admin/modules/upload",n,{headers:{"Content-Type":"multipart/form-data"}}),y("Module uploaded successfully"),m.value=!1,u.value=null,await v()}catch(l){console.error("Failed to upload module:",l),d(((a=(e=l.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to upload module")}finally{h.value=!1}},j=n=>{if(n===0)return"0 Bytes";const e=1024,a=["Bytes","KB","MB"],l=Math.floor(Math.log(n)/Math.log(e));return Math.round(n/Math.pow(e,l)*100)/100+" "+a[l]};return K(()=>{v()}),(n,e)=>{var a;return t(),o("div",W,[s("div",G,[e[15]||(e[15]=s("h1",null,"ðŸ“¦ Module Manager",-1)),s("div",H,[s("button",{class:"btn-secondary",onClick:e[0]||(e[0]=l=>m.value=!0)},[...e[13]||(e[13]=[s("span",null,"â¬†ï¸",-1),_(" Upload Module ",-1)])]),s("button",{class:"btn-primary",onClick:v},[...e[14]||(e[14]=[s("span",null,"ðŸ”„",-1),_(" Refresh ",-1)])])])]),s("div",J,[s("button",{class:z({active:g.value==="installed"}),onClick:e[1]||(e[1]=l=>g.value="installed")}," Installed Modules ",2),s("button",{class:z({active:g.value==="available"}),onClick:e[2]||(e[2]=l=>g.value="available")}," Available Modules ",2)]),U.value?(t(),o("div",O,[...e[16]||(e[16]=[s("div",{class:"spinner"},null,-1),_(" Loading modules... ",-1)])])):g.value==="installed"?(t(),o("div",Q,[I.value.length===0?(t(),o("div",X,[...e[17]||(e[17]=[s("p",null,"No modules installed.",-1),s("p",{class:"hint"},"Upload a module ZIP file to get started.",-1)])])):p("",!0),(t(!0),o(C,null,w(I.value,l=>{var M;return t(),o("div",{key:l.slug,class:"module-card installed"},[s("div",Y,[s("div",ee,i(D(l.type)),1),s("div",se,[s("h3",null,i(l.name),1),s("span",le,"v"+i(l.version),1)]),s("div",ne,[s("span",{class:z(["badge",l.enabled?"badge-success":"badge-disabled"])},i(l.enabled?"Enabled":"Disabled"),3)])]),s("p",oe,i(l.description||"No description available"),1),(M=l.dependencies)!=null&&M.length?(t(),o("div",te,[e[18]||(e[18]=s("strong",null,"Dependencies:",-1)),(t(!0),o(C,null,w(l.dependencies,r=>(t(),o("span",{key:r,class:"dep-tag"},i(r),1))),128))])):p("",!0),s("div",ae,[l.enabled?(t(),o("button",{key:0,class:"btn-action btn-warning",onClick:r=>V(l.slug)}," Disable ",8,ie)):(t(),o("button",{key:1,class:"btn-action btn-success",onClick:r=>P(l.slug)}," Enable ",8,de)),s("button",{class:"btn-action btn-danger",onClick:r=>E(l)}," Uninstall ",8,ue)])])}),128))])):(t(),o("div",re,[B.value.length===0?(t(),o("div",ce,[...e[19]||(e[19]=[s("p",null,"No modules available for installation.",-1),s("p",{class:"hint"},"Upload module ZIP files to install them.",-1)])])):p("",!0),(t(!0),o(C,null,w(B.value,l=>{var M;return t(),o("div",{key:l.slug,class:"module-card available"},[s("div",ve,[s("div",pe,i(D(l.type)),1),s("div",me,[s("h3",null,i(l.name),1),s("span",fe,"v"+i(l.version),1)])]),s("p",be,i(l.description||"No description available"),1),(M=l.dependencies)!=null&&M.length?(t(),o("div",ye,[e[20]||(e[20]=s("strong",null,"Dependencies:",-1)),(t(!0),o(C,null,w(l.dependencies,r=>(t(),o("span",{key:r,class:"dep-tag"},i(r),1))),128))])):p("",!0),s("div",ge,[s("button",{class:"btn-action btn-primary",onClick:r=>x(l.slug)}," Install ",8,ke)])])}),128))])),m.value?(t(),o("div",{key:3,class:"modal-overlay",onClick:e[8]||(e[8]=l=>m.value=!1)},[s("div",{class:"modal",onClick:e[7]||(e[7]=F(()=>{},["stop"]))},[s("div",Me,[e[21]||(e[21]=s("h2",null,"Upload Module",-1)),s("button",{class:"btn-close",onClick:e[3]||(e[3]=l=>m.value=!1)},"Ã—")]),s("div",_e,[s("div",{class:"upload-area",onDragover:e[5]||(e[5]=F(()=>{},["prevent"])),onDrop:F(A,["prevent"])},[s("input",{ref_key:"fileInput",ref:N,type:"file",accept:".zip",onChange:Z,style:{display:"none"}},null,544),s("div",{class:"upload-prompt",onClick:e[4]||(e[4]=l=>n.$refs.fileInput.click())},[...e[22]||(e[22]=[s("span",{class:"upload-icon"},"ðŸ“¦",-1),s("p",null,"Click to select or drag & drop module ZIP file",-1),s("p",{class:"hint"},"Maximum file size: 10MB",-1)])])],32),u.value?(t(),o("div",he,[s("span",null,"ðŸ“„ "+i(u.value.name),1),s("span",Ce,i(j(u.value.size)),1)])):p("",!0)]),s("div",we,[s("button",{class:"btn-cancel",onClick:e[6]||(e[6]=l=>m.value=!1)},"Cancel"),s("button",{class:"btn-submit",disabled:!u.value||h.value,onClick:L},i(h.value?"Uploading...":"Upload"),9,Fe)])])])):p("",!0),f.value?(t(),o("div",{key:4,class:"modal-overlay",onClick:e[12]||(e[12]=l=>f.value=!1)},[s("div",{class:"modal modal-confirm",onClick:e[11]||(e[11]=F(()=>{},["stop"]))},[s("div",$e,[e[23]||(e[23]=s("h2",null,"Confirm Uninstall",-1)),s("button",{class:"btn-close",onClick:e[9]||(e[9]=l=>f.value=!1)},"Ã—")]),s("div",Ue,[s("p",null,[e[24]||(e[24]=_("Are you sure you want to uninstall ",-1)),s("strong",null,i((a=k.value)==null?void 0:a.name),1),e[25]||(e[25]=_("?",-1))]),e[26]||(e[26]=s("p",{class:"warning"},"This will remove all module files and database entries. This action cannot be undone.",-1))]),s("div",ze,[s("button",{class:"btn-cancel",onClick:e[10]||(e[10]=l=>f.value=!1)},"Cancel"),s("button",{class:"btn-danger",onClick:S},"Uninstall")])])])):p("",!0)])}}},Te=q(Ie,[["__scopeId","data-v-e98fa001"]]);export{Te as default};
