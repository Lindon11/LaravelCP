import{_ as le,G as ae,h as l,a as e,k as _,v as U,H as oe,F as y,i as p,l as d,t as n,d as ne,m as z,s as ie,j as re,g as r,x as u,q as de,o as a,n as N}from"./index-BXuq4ZjH.js";const ue={class:"user-tools"},ce={class:"view-header"},ve={class:"flex items-center justify-between"},ye={class:"search-box"},pe={class:"relative"},me={key:0,class:"search-results"},he=["onClick"],_e={class:"font-medium"},be={class:"text-slate-400 text-sm ml-2"},ge={class:"text-slate-500 text-xs ml-2"},fe={key:0,class:"empty-state"},ke={key:1,class:"user-view"},xe={class:"user-header"},we={class:"user-info"},Ce={class:"user-avatar"},Te={class:"text-xl font-bold text-slate-100"},Fe={class:"text-slate-500 text-sm font-normal"},$e={class:"text-sm text-slate-400 mt-1"},Ue={class:"tabs"},Ne=["onClick"],Le={class:"tab-content"},Se={key:0,class:"tab-panel"},Ve={class:"panel-header"},Ae={class:"text-sm text-slate-400"},je={key:0,class:"loading"},De={key:1,class:"data-table"},Re={class:"badge"},Ie={class:"codename"},Je={key:0,class:"text-green-400"},qe={key:1,class:"text-slate-500"},He={key:2,class:"empty"},Be={key:1,class:"tab-panel"},Me={key:0,class:"loading"},Ee={key:1,class:"data-table"},Ge={class:"codename"},ze={class:"badge"},Ke={key:2,class:"empty"},Qe={key:2,class:"tab-panel"},Oe={class:"panel-header"},We={key:0,class:"loading"},Ye={key:1,class:"data-table"},Pe={class:"codename"},Xe={class:"badge"},Ze={key:0,class:"text-green-400"},et={key:1,class:"text-red-400"},tt={key:2,class:"text-slate-400"},st={key:2,class:"empty"},lt={key:3,class:"tab-panel"},at={key:0,class:"loading"},ot={key:1,class:"data-table"},nt=["onClick"],it={key:2,class:"empty"},rt={key:4,class:"tab-panel"},dt={class:"panel-header"},ut={key:0,class:"loading"},ct={key:1,class:"flags-grid"},vt={class:"flag-header"},yt={class:"flag-label"},pt=["onClick"],mt={key:0,class:"flag-value"},ht={key:1,class:"flag-reason"},_t={key:2,class:"empty"},bt={class:"modal"},gt={class:"form-group"},ft={class:"form-group"},kt={class:"form-group"},xt={class:"form-group"},wt={class:"modal-actions"},Ct={key:5,class:"tab-panel"},Tt={key:0,class:"loading"},Ft={key:1,class:"data-table"},$t={key:2,class:"empty"},Ut={__name:"UserToolsView",setup(Nt){const b=r(""),k=r([]),i=r(null),c=r("items"),K=[{key:"items",label:"Items"},{key:"jobs",label:"Jobs"},{key:"history",label:"Job History"},{key:"timers",label:"Timers"},{key:"flags",label:"Flags"},{key:"activity",label:"Activity"}],m=r({}),x=r([]),w=r([]),C=r({timers:[],user_timers:[]}),T=r([]),F=r([]),L=r("all"),S=r(!1),V=r(!1),A=r(!1),j=r(!1),D=r(!1),R=r(!1),g=r(!1),v=r({type:"",label:"",reason:"",severity:"info"}),B=de(()=>{const o=[...C.value.user_timers||[]];for(const s of C.value.timers||[])o.push({type:s.type,expires_at:s.expires_at});return o}),M=async()=>{if(b.value.trim())try{const o=await u.get("/admin/user-tools/search",{params:{q:b.value}});k.value=o.data.users||[]}catch(o){console.error("Search failed:",o)}},Q=async o=>{k.value=[],b.value="";try{const s=await u.get(`/admin/user-tools/${o.id}`);i.value=s.data.user,E()}catch(s){console.error("Failed to load user:",s)}},O=()=>{i.value=null,m.value={},x.value=[],w.value=[],C.value={timers:[],user_timers:[]},T.value=[],F.value=[]},E=()=>{if(i.value)switch(c.value){case"items":W();break;case"jobs":Y();break;case"history":G();break;case"timers":I();break;case"flags":J();break;case"activity":ee();break}},W=async()=>{S.value=!0;try{const o=await u.get(`/admin/user-tools/${i.value.id}/inventory`);m.value=o.data}catch(o){console.error("Failed to load inventory:",o)}finally{S.value=!1}},Y=async()=>{V.value=!0;try{const o=await u.get(`/admin/user-tools/${i.value.id}/jobs`);x.value=o.data.jobs||[]}catch(o){console.error("Failed to load jobs:",o)}finally{V.value=!1}},G=async()=>{A.value=!0;try{const o=await u.get(`/admin/user-tools/${i.value.id}/job-history`,{params:{type:L.value}});w.value=o.data.history||[]}catch(o){console.error("Failed to load job history:",o)}finally{A.value=!1}},I=async()=>{j.value=!0;try{const o=await u.get(`/admin/user-tools/${i.value.id}/timers`);C.value=o.data}catch(o){console.error("Failed to load timers:",o)}finally{j.value=!1}},P=async o=>{if(confirm(`Clear ${o} timer?`))try{await u.delete(`/admin/user-tools/${i.value.id}/timers/${o}`),I()}catch{alert("Failed to clear timer")}},J=async()=>{D.value=!0;try{const o=await u.get(`/admin/user-tools/${i.value.id}/flags`);T.value=o.data.flags||[]}catch(o){console.error("Failed to load flags:",o)}finally{D.value=!1}},X=async()=>{try{await u.post(`/admin/user-tools/${i.value.id}/flags`,v.value),g.value=!1,v.value={type:"",label:"",reason:"",severity:"info"},J()}catch{alert("Failed to add flag")}},Z=async o=>{if(confirm(`Remove ${o} flag?`))try{await u.delete(`/admin/user-tools/${i.value.id}/flags/${o}`),J()}catch{alert("Failed to remove flag")}},ee=async()=>{R.value=!0;try{const o=await u.get(`/admin/user-tools/${i.value.id}/activity`);F.value=o.data.activity||[]}catch(o){console.error("Failed to load activity:",o)}finally{R.value=!1}},$=o=>o?new Date(o).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).replace(","," at"):"-",te=o=>{const s=new Date,h=new Date(o)-s;if(h<=0)return"Expired";const f=Math.floor(h/(1e3*60*60)),t=Math.floor(h%(1e3*60*60)/(1e3*60));return f>0?`${f}h ${t}m`:`${t}m`},se=o=>o.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase());return ae(c,E),(o,s)=>{var q,h,f;return a(),l("div",ue,[e("div",ce,[e("div",ve,[s[9]||(s[9]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-100"},"User Tools"),e("p",{class:"text-slate-400 mt-1"},"Inspect and manage individual user data")],-1)),e("div",ye,[e("div",pe,[_(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>b.value=t),type:"text",placeholder:"Search by username, email, or ID...",class:"search-input",onKeyup:oe(M,["enter"])},null,544),[[U,b.value]]),e("button",{onClick:M,class:"search-btn"}," ðŸ” Find User ")]),k.value.length>0?(a(),l("div",me,[(a(!0),l(y,null,p(k.value,t=>(a(),l("div",{key:t.id,class:"search-result-item",onClick:H=>Q(t)},[e("span",_e,n(t.username),1),e("span",be,"#"+n(t.id),1),e("span",ge,"Lvl "+n(t.level),1)],8,he))),128))])):d("",!0)])])]),i.value?(a(),l("div",ke,[e("div",xe,[e("div",we,[e("div",Ce,n(i.value.username.charAt(0).toUpperCase()),1),e("div",null,[e("h2",Te,[ne(" User Tools: "+n(i.value.username)+" ",1),e("span",Fe,"#"+n(i.value.id),1)]),e("div",$e," Level "+n(i.value.level)+" Â· "+n(((q=i.value.current_rank)==null?void 0:q.name)||"No Rank")+" Â· "+n(((h=i.value.location)==null?void 0:h.name)||"Unknown Location"),1)])]),e("button",{onClick:O,class:"btn btn-secondary"}," âœ• Clear ")]),e("div",Ue,[(a(),l(y,null,p(K,t=>e("button",{key:t.key,class:N(["tab",{active:c.value===t.key}]),onClick:H=>c.value=t.key},n(t.label),11,Ne)),64))]),e("div",Le,[c.value==="items"?(a(),l("div",Se,[e("div",Ve,[s[11]||(s[11]=e("h3",null,"Inventory Items",-1)),e("div",Ae," Total: "+n(m.value.total_items||0)+" items Â· Value: $"+n((m.value.total_value||0).toLocaleString()),1)]),S.value?(a(),l("div",je,"Loading inventory...")):(f=m.value.inventory)!=null&&f.length?(a(),l("table",De,[s[12]||(s[12]=e("thead",null,[e("tr",null,[e("th",null,"Item Name"),e("th",null,"Type"),e("th",null,"Codename"),e("th",null,"Quantity"),e("th",null,"Value"),e("th",null,"Equipped")])],-1)),e("tbody",null,[(a(!0),l(y,null,p(m.value.inventory,t=>(a(),l("tr",{key:t.id},[e("td",null,n(t.item_name),1),e("td",null,[e("span",Re,n(t.item_type),1)]),e("td",null,[e("code",Ie,n(t.item_codename||"-"),1)]),e("td",null,n(t.quantity),1),e("td",null,"$"+n((t.item_value*t.quantity).toLocaleString()),1),e("td",null,[t.equipped?(a(),l("span",Je,"âœ“")):(a(),l("span",qe,"-"))])]))),128))])])):(a(),l("div",He,"No items in inventory"))])):d("",!0),c.value==="jobs"?(a(),l("div",Be,[s[14]||(s[14]=e("div",{class:"panel-header"},[e("h3",null,"Job Statistics")],-1)),V.value?(a(),l("div",Me,"Loading jobs...")):x.value.length?(a(),l("table",Ee,[s[13]||(s[13]=e("thead",null,[e("tr",null,[e("th",null,"Job Name"),e("th",null,"Codename"),e("th",null,"Type"),e("th",null,"Total Completed")])],-1)),e("tbody",null,[(a(!0),l(y,null,p(x.value,t=>(a(),l("tr",{key:t.codename},[e("td",null,n(t.name),1),e("td",null,[e("code",Ge,n(t.codename||"-"),1)]),e("td",null,[e("span",ze,n(t.type),1)]),e("td",null,n(t.total_completed),1)]))),128))])])):(a(),l("div",Ke,"No job statistics found"))])):d("",!0),c.value==="history"?(a(),l("div",Qe,[e("div",Oe,[s[16]||(s[16]=e("h3",null,"Job History",-1)),_(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>L.value=t),onChange:G,class:"filter-select"},[...s[15]||(s[15]=[ie('<option value="all" data-v-37832544>All Types</option><option value="crime_attempt" data-v-37832544>Crimes</option><option value="theft_attempt" data-v-37832544>Theft</option><option value="gym_train" data-v-37832544>Gym</option><option value="organized_crime" data-v-37832544>Organized Crime</option>',5)])],544),[[z,L.value]])]),A.value?(a(),l("div",We,"Loading history...")):w.value.length?(a(),l("table",Ye,[s[17]||(s[17]=e("thead",null,[e("tr",null,[e("th",null,"Job Name"),e("th",null,"Codename"),e("th",null,"Type"),e("th",null,"Result"),e("th",null,"Time")])],-1)),e("tbody",null,[(a(!0),l(y,null,p(w.value,t=>(a(),l("tr",{key:t.id},[e("td",null,n(t.name),1),e("td",null,[e("code",Pe,n(t.codename||"-"),1)]),e("td",null,[e("span",Xe,n(t.type),1)]),e("td",null,[t.success===!0?(a(),l("span",Ze,"Success")):t.success===!1?(a(),l("span",et,"Failed")):(a(),l("span",tt,"-"))]),e("td",null,n($(t.time)),1)]))),128))])])):(a(),l("div",st,"No job history found"))])):d("",!0),c.value==="timers"?(a(),l("div",lt,[e("div",{class:"panel-header"},[s[18]||(s[18]=e("h3",null,"Active Timers & Cooldowns",-1)),e("button",{onClick:I,class:"btn btn-secondary btn-sm"},"ðŸ”„ Refresh")]),j.value?(a(),l("div",at,"Loading timers...")):B.value.length?(a(),l("table",ot,[s[19]||(s[19]=e("thead",null,[e("tr",null,[e("th",null,"Timer Type"),e("th",null,"Expires At"),e("th",null,"Remaining"),e("th",null,"Actions")])],-1)),e("tbody",null,[(a(!0),l(y,null,p(B.value,t=>(a(),l("tr",{key:t.type},[e("td",null,[e("span",{class:N(["badge",t.type])},n(se(t.type)),3)]),e("td",null,n($(t.expires_at)),1),e("td",null,n(te(t.expires_at)),1),e("td",null,[e("button",{onClick:H=>P(t.type),class:"btn btn-danger btn-sm"}," Clear ",8,nt)])]))),128))])])):(a(),l("div",it,"No active timers"))])):d("",!0),c.value==="flags"?(a(),l("div",rt,[e("div",dt,[s[20]||(s[20]=e("h3",null,"User Flags & Tags",-1)),e("button",{onClick:s[2]||(s[2]=t=>g.value=!0),class:"btn btn-primary btn-sm"},"+ Add Flag")]),D.value?(a(),l("div",ut,"Loading flags...")):T.value.length?(a(),l("div",ct,[(a(!0),l(y,null,p(T.value,t=>(a(),l("div",{key:t.type,class:N(["flag-card",t.severity])},[e("div",vt,[e("span",yt,n(t.label),1),t.type!=="role"?(a(),l("button",{key:0,onClick:H=>Z(t.type),class:"flag-remove"},"Ã—",8,pt)):d("",!0)]),t.value&&t.value!==!0?(a(),l("div",mt,n(typeof t.value=="string"&&t.value.includes("T")?$(t.value):t.value),1)):d("",!0),t.reason?(a(),l("div",ht,n(t.reason),1)):d("",!0)],2))),128))])):(a(),l("div",_t,"No flags assigned")),g.value?(a(),l("div",{key:3,class:"modal-overlay",onClick:s[8]||(s[8]=re(t=>g.value=!1,["self"]))},[e("div",bt,[s[26]||(s[26]=e("h3",null,"Add Flag",-1)),e("div",gt,[s[21]||(s[21]=e("label",null,"Flag Type",-1)),_(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>v.value.type=t),type:"text",placeholder:"e.g., suspicious, vip, warning"},null,512),[[U,v.value.type]])]),e("div",ft,[s[22]||(s[22]=e("label",null,"Label",-1)),_(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>v.value.label=t),type:"text",placeholder:"Display label"},null,512),[[U,v.value.label]])]),e("div",kt,[s[23]||(s[23]=e("label",null,"Reason (optional)",-1)),_(e("textarea",{"onUpdate:modelValue":s[5]||(s[5]=t=>v.value.reason=t),placeholder:"Reason for flag"},null,512),[[U,v.value.reason]])]),e("div",xt,[s[25]||(s[25]=e("label",null,"Severity",-1)),_(e("select",{"onUpdate:modelValue":s[6]||(s[6]=t=>v.value.severity=t)},[...s[24]||(s[24]=[e("option",{value:"info"},"Info (Blue)",-1),e("option",{value:"success"},"Success (Green)",-1),e("option",{value:"warning"},"Warning (Yellow)",-1),e("option",{value:"danger"},"Danger (Red)",-1)])],512),[[z,v.value.severity]])]),e("div",wt,[e("button",{onClick:s[7]||(s[7]=t=>g.value=!1),class:"btn btn-secondary"},"Cancel"),e("button",{onClick:X,class:"btn btn-primary"},"Add Flag")])])])):d("",!0)])):d("",!0),c.value==="activity"?(a(),l("div",Ct,[s[28]||(s[28]=e("div",{class:"panel-header"},[e("h3",null,"Recent Activity")],-1)),R.value?(a(),l("div",Tt,"Loading activity...")):F.value.length?(a(),l("table",Ft,[s[27]||(s[27]=e("thead",null,[e("tr",null,[e("th",null,"Type"),e("th",null,"Description"),e("th",null,"Time")])],-1)),e("tbody",null,[(a(!0),l(y,null,p(F.value,t=>(a(),l("tr",{key:t.id},[e("td",null,[e("span",{class:N(["badge",t.type])},n(t.type),3)]),e("td",null,n(t.description),1),e("td",null,n($(t.created_at)),1)]))),128))])])):(a(),l("div",$t,"No activity found"))])):d("",!0)])])):(a(),l("div",fe,[...s[10]||(s[10]=[e("div",{class:"text-6xl mb-4"},"ðŸ‘¤",-1),e("h3",{class:"text-xl text-slate-300 mb-2"},"No User Selected",-1),e("p",{class:"text-slate-500"},"Search for a user above to view their details",-1)])]))])}}},St=le(Ut,[["__scopeId","data-v-37832544"]]);export{St as default};
